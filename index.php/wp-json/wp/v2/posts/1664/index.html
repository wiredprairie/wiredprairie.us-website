{"id":1664,"date":"2012-05-13T11:59:54","date_gmt":"2012-05-13T16:59:54","guid":{"rendered":"http:\/\/www.wiredprairie.us\/blog\/?p=1664"},"modified":"2012-05-13T11:59:55","modified_gmt":"2012-05-13T16:59:55","slug":"a-bit-of-reflow-using-tweenjs","status":"publish","type":"post","link":"https:\/\/www.wiredprairie.us\/blog\/index.php\/archives\/1664","title":{"rendered":"A bit of reflow, using TweenJS"},"content":{"rendered":"<p>Inspired by some modern applications (especially the \u201cMetro\u201d look and feel), I wanted to put together an animated tile reflow script for an HTML page I was creating. <\/p>\n<p>As the size of the page changes, the tiles move into their new positions.<\/p>\n<p><a href=\"http:\/\/www.wiredprairie.us\/examples\/easeljs\/reflow1\/\" target=\"_blank\"><img loading=\"lazy\" style=\"background-image: none; border-bottom: 0px; border-left: 0px; margin: 0px auto; padding-left: 0px; padding-right: 0px; display: block; float: none; border-top: 0px; border-right: 0px; padding-top: 0px\" title=\"SNAGHTML113b633f[4]\" border=\"0\" alt=\"SNAGHTML113b633f[4]\" src=\"http:\/\/www.wiredprairie.us\/blog\/wp-content\/uploads\/2012\/05\/SNAGHTML113b633f4.png\" width=\"502\" height=\"408\" \/><\/a><\/p>\n<p>You can try it <a href=\"http:\/\/www.wiredprairie.us\/examples\/easeljs\/reflow1\/\" target=\"_blank\">here<\/a>, if you\u2019re using a modern browser (IE9+, Chrome, FF, Safari, etc.).<\/p>\n<p>Dependencies:<\/p>\n<ol>\n<li><a href=\"http:\/\/createjs.com\/#!\/TweenJS\" target=\"_blank\">TweenJS<\/a><\/li>\n<li><a href=\"http:\/\/createjs.com\/#!\/EaselJS\" target=\"_blank\">EaselJS<\/a> (for the ticker used in TweenJS)<\/li>\n<li>CSSPlugin (an add on to the the TweenJS library)<\/li>\n<li><a href=\"http:\/\/www.jquery.com\" target=\"_blank\">jQuery<\/a> (1.7.2)<\/li>\n<\/ol>\n<p> Relayouts are queued (as to prevent multiple from running).<\/p>\n<p>Only boxes that will be visible to the end user (either animating to the screen or off the screen) are animated. It does not animate elements that do not start or end in the current viewport including boxes that would animate \u201cthrough\u201d the current viewport. I considered the latter to not add anything to the overall experience and just uses more CPU to perform the animations, so I intentionally left it out.<\/p>\n<p>In the layout loop, the code verifies that the animation needs to run:<\/p>\n<pre class=\"code\"><span style=\"color: #006400\">\/\/ here's the final destination\n<\/span>pos = { left: Math.round(x), top: Math.round(y) };\n\n<span style=\"color: #006400\">\/\/ check old and new positions, if either are in the viewport, we'll animate\n<\/span><span style=\"color: blue\">if <\/span>(isScrolledIntoView(pos.top + parentOfBoxesOffsetTop, boxH) || isScrolledIntoView(box.y + parentOfBoxesOffsetTop, boxH)) {\n    Tween.get(box.e).to(pos, 500 + 500 * Math.random(), \n        Ease.quadInOut).call(<span style=\"color: blue\">function <\/span>() {\n            --layoutPending;\n            <span style=\"color: blue\">if <\/span>(!layoutPending &amp;&amp; queuedLayout) { queueLayout(); }\n    });\n} <span style=\"color: blue\">else <\/span>{<\/pre>\n<p>If it needs to animate, the code uses the static Tween method \u201cget\u201d to start an animation on the current element. <\/p>\n<ol>\n<li>Tween.get(box.e) creates a new instance of the Tween class (initialized with the element to tween).<\/li>\n<li>Using that Tween instance, the CSS attributes (thanks to the handy CSSPlugin), for left and top are animated for at least 500ms and up to a full second. The easing function I chose is quadInOut. Tip: <a href=\"http:\/\/www.createjs.com\/#!\/TweenJS\/demos\/sparkTable\" target=\"_blank\">Here\u2019s<\/a> a great way to visualize easing options using TweenJS.<\/li>\n<li>Finally, when the animation completes, an anonymous function is called which decrements the number of pending animations and if there are no remaining elements to animate, and there\u2019s something queued, another cycle is started.<\/li>\n<\/ol>\n<p>All the code used by the demo is in default.html.<\/p>\n<p>Colors of the boxes were set using hsl (only available in modern browsers):<\/p>\n<pre class=\"code\">box.style.backgroundColor = <span style=\"color: maroon\">&quot;hsl(&quot; <\/span>+ c + <span style=\"color: maroon\">&quot;, 100%, 50%)&quot;<\/span>;<\/pre>\n<p>Where \u201cc\u201d is:<\/p>\n<pre class=\"code\">c = (i \/ boxes * 360).toFixed(1);<\/pre>\n","protected":false},"excerpt":{"rendered":"<p>Inspired by some modern applications (especially the \u201cMetro\u201d look and feel), I wanted to put together an animated tile reflow script for an HTML page I was creating. As the size of the page changes, the tiles move into their new positions. You can try it here, if you\u2019re using a modern browser (IE9+, Chrome, [&hellip;]<\/p>\n","protected":false},"author":2,"featured_media":0,"comment_status":"open","ping_status":"open","sticky":false,"template":"","format":"standard","meta":{"spay_email":"","jetpack_publicize_message":"","jetpack_is_tweetstorm":false,"jetpack_publicize_feature_enabled":true},"categories":[4],"tags":[38,96,98],"jetpack_publicize_connections":[],"jetpack_featured_media_url":"","jetpack_sharing_enabled":true,"jetpack_shortlink":"https:\/\/wp.me\/pd5QIe-qQ","jetpack_likes_enabled":true,"jetpack-related-posts":[{"id":1996,"url":"https:\/\/www.wiredprairie.us\/blog\/index.php\/archives\/1996","url_meta":{"origin":1664,"position":0},"title":"Animating an element&rsquo;s visibility using AngularJS","date":"January 31, 2014","format":false,"excerpt":"There was a question on StackOverflow about animating an element and I wanted to give it a shot, so here goes: http:\/\/jsfiddle.net\/wiredprairie\/5tFCZ\/1\/ \u00a0 Imagine nearly the simplest Angular JS application possible: <div ng-app=\"App\"> <div ng-init=\"checked=true\"> <div> <label> <input type=\"checkbox\" ng-model=\"checked\" \/>Is Visible...<\/label> <\/div> <div class=\"sample\" ng-class=\"{ hidden: !checked }\">Visible...<\/div> <\/div>\u2026","rel":"","context":"In &quot;Coding&quot;","img":{"alt_text":"","src":"","width":0,"height":0},"classes":[]},{"id":1570,"url":"https:\/\/www.wiredprairie.us\/blog\/index.php\/archives\/1570","url_meta":{"origin":1664,"position":1},"title":"JavaScript: isScrolledIntoView","date":"March 15, 2012","format":false,"excerpt":"I needed a simple way to detect when a placeholder DIV (that would contain an image) had scrolled into the current viewport of the browser. I\u2019ve seen a few solutions that worked, and a few that didn\u2019t (hello? test your code!). Here\u2019s my simple solution: function isScrolledIntoView(elem) { elem =\u2026","rel":"","context":"In &quot;Coding&quot;","img":{"alt_text":"SmugMupBrowser-live","src":"https:\/\/i0.wp.com\/www.wiredprairie.us\/blog\/wp-content\/uploads\/2012\/03\/SmugMupBrowser-live.gif?resize=350%2C200","width":350,"height":200},"classes":[]},{"id":1705,"url":"https:\/\/www.wiredprairie.us\/blog\/index.php\/archives\/1705","url_meta":{"origin":1664,"position":2},"title":"WinRT\/Xaml\/AKA Metro DataTemplate selection based on Data Types","date":"August 20, 2012","format":false,"excerpt":"You may have noticed that WinRT does not have automatic resolution of a DataTemplate based on the data type of object added to an ItemsControl. While unfortunate as this behavior is quite handy, it\u2019s not too difficult to replicate the functionality using a DataTemplateSelector. WPF for example, could do something\u2026","rel":"","context":"In &quot;Coding&quot;","img":{"alt_text":"","src":"","width":0,"height":0},"classes":[]},{"id":1749,"url":"https:\/\/www.wiredprairie.us\/blog\/index.php\/archives\/1749","url_meta":{"origin":1664,"position":3},"title":"Nest Update #12: Software at 3.0 with New Features","date":"October 3, 2012","format":false,"excerpt":"As the blogosphere exploded yesterday with news of a second generation Nest thermostat and a new major version of the software (for the thermostats and the controllers such as the web site and various SmartPhones), I wondered what impact the new software and hardware would have on average users, like\u2026","rel":"","context":"In &quot;Recommendations&quot;","img":{"alt_text":"IMG_0630","src":"https:\/\/i0.wp.com\/www.wiredprairie.us\/blog\/wp-content\/uploads\/2012\/10\/IMG_0630.png?resize=350%2C200","width":350,"height":200},"classes":[]},{"id":633,"url":"https:\/\/www.wiredprairie.us\/blog\/index.php\/archives\/633","url_meta":{"origin":1664,"position":4},"title":"A Silverlight 2 TilePanel","date":"December 14, 2008","format":false,"excerpt":"You may notice that the Silverlight TileBrush is missing some key properties which would enable it to actually tile a brush. The WPF TileBrush has properties such as TileMode, Viewbox, and ViewportUnits that can be used to tile an image as a fill or as a background for a UIElement.\u2026","rel":"","context":"In &quot;Coding&quot;","img":{"alt_text":"","src":"https:\/\/i0.wp.com\/www.wiredprairie.us\/blog\/wp-content\/uploads\/2008\/12\/image1.png?resize=350%2C200","width":350,"height":200},"classes":[]},{"id":2124,"url":"https:\/\/www.wiredprairie.us\/blog\/index.php\/archives\/2124","url_meta":{"origin":1664,"position":5},"title":"Alternatives to Monopoly: Some table-top board games you should try","date":"November 28, 2016","format":false,"excerpt":"In the USA, there are some traditional board games that are\u00a0commonly found in the closets of many households. The staple board games if you will. Monopoly comes to mind for example. If you did a survey of 100 adults in the USA to name a board-game, I'd bet Monopoly would\u2026","rel":"","context":"In &quot;General&quot;","img":{"alt_text":"","src":"https:\/\/i0.wp.com\/www.wiredprairie.us\/blog\/wp-content\/uploads\/2016\/11\/TicketToRideBanner.jpg?resize=350%2C200&ssl=1","width":350,"height":200},"classes":[]}],"_links":{"self":[{"href":"https:\/\/www.wiredprairie.us\/blog\/index.php\/wp-json\/wp\/v2\/posts\/1664"}],"collection":[{"href":"https:\/\/www.wiredprairie.us\/blog\/index.php\/wp-json\/wp\/v2\/posts"}],"about":[{"href":"https:\/\/www.wiredprairie.us\/blog\/index.php\/wp-json\/wp\/v2\/types\/post"}],"author":[{"embeddable":true,"href":"https:\/\/www.wiredprairie.us\/blog\/index.php\/wp-json\/wp\/v2\/users\/2"}],"replies":[{"embeddable":true,"href":"https:\/\/www.wiredprairie.us\/blog\/index.php\/wp-json\/wp\/v2\/comments?post=1664"}],"version-history":[{"count":1,"href":"https:\/\/www.wiredprairie.us\/blog\/index.php\/wp-json\/wp\/v2\/posts\/1664\/revisions"}],"predecessor-version":[{"id":1665,"href":"https:\/\/www.wiredprairie.us\/blog\/index.php\/wp-json\/wp\/v2\/posts\/1664\/revisions\/1665"}],"wp:attachment":[{"href":"https:\/\/www.wiredprairie.us\/blog\/index.php\/wp-json\/wp\/v2\/media?parent=1664"}],"wp:term":[{"taxonomy":"category","embeddable":true,"href":"https:\/\/www.wiredprairie.us\/blog\/index.php\/wp-json\/wp\/v2\/categories?post=1664"},{"taxonomy":"post_tag","embeddable":true,"href":"https:\/\/www.wiredprairie.us\/blog\/index.php\/wp-json\/wp\/v2\/tags?post=1664"}],"curies":[{"name":"wp","href":"https:\/\/api.w.org\/{rel}","templated":true}]}}