{"id":634,"date":"2008-12-15T17:40:07","date_gmt":"2008-12-15T22:40:07","guid":{"rendered":"http:\/\/www.wiredprairie.us\/blog\/index.php\/archives\/634"},"modified":"2008-12-15T17:40:07","modified_gmt":"2008-12-15T22:40:07","slug":"converting-restful-xml-output-to-formatted-xml-in-silverlight","status":"publish","type":"post","link":"https:\/\/www.wiredprairie.us\/blog\/index.php\/archives\/634","title":{"rendered":"Converting RESTful XML output to formatted XML in Silverlight"},"content":{"rendered":"<p>Ever debugged output from a <a target=\"_blank\" href=\"http:\/\/en.wikipedia.org\/wiki\/Representational_State_Transfer\">RESTful<\/a> web service and was driven absolutely mad by the lack of formatting of the XML? Seriously, how much fun is it to stare at XML that has no line breaks or indentation whatsoever? <\/p>\n<p>I haven\u2019t tried to solve the problem within the IDE as that\u2019s a different problem. However, I have written the code to convert the output into something that you could stuff into a TextBox for example (which is what I\u2019ve done in my Silverlight application \u2013 I\u2019ve created a small debug window for RESTFul web service calls).<\/p>\n<p>&#160;<\/p>\n<p> <a href=\"http:\/\/11011.net\/software\/vspaste\"><\/a>  <\/p>\n<pre class=\"code\"><span style=\"color: #2b91af\">HttpWebRequest <\/span>request = (<span style=\"color: #2b91af\">HttpWebRequest<\/span>)\n    <span style=\"color: #2b91af\">HttpWebRequest<\/span>.Create(<span style=\"color: blue\">new <\/span><span style=\"color: #2b91af\">Uri<\/span>(<span style=\"color: #a31515\">&quot;http:\/\/localhost:12345\/MyWebService.asmx&quot;<\/span>));<\/pre>\n<p><a href=\"http:\/\/11011.net\/software\/vspaste\"><\/a><\/p>\n<pre class=\"code\">request.BeginGetResponse(<span style=\"color: blue\">delegate<\/span>(<span style=\"color: #2b91af\">IAsyncResult <\/span>ar)\n{\n    <span style=\"color: #2b91af\">HttpWebRequest <\/span>req = (<span style=\"color: #2b91af\">HttpWebRequest<\/span>)ar.AsyncState;\n    <span style=\"color: #2b91af\">HttpWebResponse <\/span>webResponse = req.EndGetResponse(ar) <span style=\"color: blue\">as <\/span><span style=\"color: #2b91af\">HttpWebResponse<\/span>;\n    <span style=\"color: blue\">try\n    <\/span>{\n        <span style=\"color: blue\">using <\/span>(<span style=\"color: #2b91af\">Stream <\/span>stream = webResponse.GetResponseStream())\n        {\n            <span style=\"color: #2b91af\">XmlReader <\/span>xmlReader = <span style=\"color: #2b91af\">XmlReader<\/span>.Create(stream);\n            <span style=\"color: blue\">try\n            <\/span>{\n                <span style=\"color: #2b91af\">XmlWriterSettings <\/span>settings = <span style=\"color: blue\">new <\/span><span style=\"color: #2b91af\">XmlWriterSettings<\/span>();                            \n                settings.Indent = <span style=\"color: blue\">true<\/span>;\n                settings.Encoding = System.Text.<span style=\"color: #2b91af\">Encoding<\/span>.Unicode;\n                <span style=\"color: blue\">using <\/span>(<span style=\"color: #2b91af\">StringWriter <\/span>strWriter = <span style=\"color: blue\">new <\/span><span style=\"color: #2b91af\">StringWriter<\/span>())\n                {\n                    <span style=\"color: #2b91af\">XmlWriter <\/span>xmlWriter = <span style=\"color: #2b91af\">XmlWriter<\/span>.Create(strWriter, settings);\n                    <span style=\"color: blue\">try\n                    <\/span>{\n                        <span style=\"color: green\">\/\/ cool, this recursively writes all of the nodes!\n                        <\/span>xmlWriter.WriteNode(xmlReader, <span style=\"color: blue\">false<\/span>);\n\n                        <span style=\"color: green\">\/\/ output it to the UI as a string \n                        <\/span>Dispatcher.BeginInvoke(<span style=\"color: blue\">delegate<\/span>()\n                        {\n                            txtRawResults.Text = strWriter.ToString();\n                        });\n                    }\n                    <span style=\"color: blue\">finally\n                    <\/span>{\n                        xmlWriter.Close();\n                    }\n                }\n            }\n            <span style=\"color: blue\">finally\n            <\/span>{\n                xmlReader.Close();\n            }\n\n            stream.Close();\n        }\n    }\n    <span style=\"color: blue\">finally\n    <\/span>{\n        webResponse.Close();\n    }\n}, request);<\/pre>\n<p><a href=\"http:\/\/11011.net\/software\/vspaste\"><\/a><\/p>\n<p><strong>Replace the Uri in the first line with a call to your web service that returns XML. <\/strong><\/p>\n<p>Steps:<\/p>\n<ol>\n<li>The Response is requested asynchronously (as is the only option with Silverlight)<\/li>\n<li>Within the anonymous method, the request is retrieved from the IAyncResult object instance (ar)<\/li>\n<li>The async request is properly ended (EndGetResponse) and retreieved<\/li>\n<li>The stream is fetched from the response and passed to a new XmlReader instance.<\/li>\n<li>Create a new instance of the XmlWriterSettings object with indentation activated (Indent = True)<\/li>\n<li>Create a new XmlWriter instance using a new instance of a string writer and the settings created in step #5<\/li>\n<li>Recursively (thanks to the WriteNode method), write the entire document to the writer, formatted with indentations as requested!<\/li>\n<li>Invoke back to the UI thread with the result of the formatted, recursive WriteNode call.<\/li>\n<li>Clean up.<\/li>\n<\/ol>\n","protected":false},"excerpt":{"rendered":"<p>Ever debugged output from a RESTful web service and was driven absolutely mad by the lack of formatting of the XML? Seriously, how much fun is it to stare at XML that has no line breaks or indentation whatsoever? I haven\u2019t tried to solve the problem within the IDE as that\u2019s a different problem. However, [&hellip;]<\/p>\n","protected":false},"author":2,"featured_media":0,"comment_status":"open","ping_status":"open","sticky":false,"template":"","format":"standard","meta":{"spay_email":"","jetpack_publicize_message":"","jetpack_is_tweetstorm":false,"jetpack_publicize_feature_enabled":true},"categories":[4],"tags":[153],"jetpack_publicize_connections":[],"jetpack_featured_media_url":"","jetpack_sharing_enabled":true,"jetpack_shortlink":"https:\/\/wp.me\/pd5QIe-ae","jetpack_likes_enabled":true,"jetpack-related-posts":[{"id":388,"url":"https:\/\/www.wiredprairie.us\/blog\/index.php\/archives\/388","url_meta":{"origin":634,"position":0},"title":"Silverlight Weather Demonstration","date":"June 26, 2008","format":false,"excerpt":"Demonstration available here. (You'll need to wait for a moment while it loads the first time). I've created a reasonably simple, yet multi-technology (and discipline) demonstration using Silverlight for the user interface and ASP.NET as the back-end. The demonstration uses: Silverlight 2.0 Data binding Delayed downloading of images \"Web services\"\u2026","rel":"","context":"In &quot;Coding&quot;","img":{"alt_text":"","src":"https:\/\/i0.wp.com\/www.wiredprairie.us\/blog\/wp-content\/uploads\/2008\/06\/image21.png?resize=350%2C200","width":350,"height":200},"classes":[]},{"id":670,"url":"https:\/\/www.wiredprairie.us\/blog\/index.php\/archives\/670","url_meta":{"origin":634,"position":1},"title":"Silverlight: Dynamically creating XAML elements  at runtime","date":"January 19, 2009","format":false,"excerpt":"Given the following XML file: <assets> <asset name=\"tile\"> <Canvas xmlns=\"http:\/\/schemas.microsoft.com\/winfx\/2006\/xaml\/presentation\" xmlns:x=\"http:\/\/schemas.microsoft.com\/winfx\/2006\/xaml\"> <Path x:Name=\"top\" Width=\"24\" Height=\"12\" Stretch=\"Fill\" Fill=\"#FF065F02\" Stroke=\"#10000000\" Data=\"F1 M 0,6L 12,12L 24,6L 12,0L 0,6 Z \"\/> <\/Canvas> <\/asset> <\/assets> It\u2019s easy enough to create reusable assets in Silverlight and load them on demand from XML, and refer to the\u2026","rel":"","context":"In &quot;Coding&quot;","img":{"alt_text":"image","src":"https:\/\/i0.wp.com\/www.wiredprairie.us\/blog\/wp-content\/uploads\/2009\/01\/image8.png?resize=350%2C200","width":350,"height":200},"classes":[]},{"id":1016,"url":"https:\/\/www.wiredprairie.us\/blog\/index.php\/archives\/1016","url_meta":{"origin":634,"position":2},"title":"Silverlight vs. Flash vs. Photoshop Text Rendering","date":"March 24, 2010","format":false,"excerpt":"Curious about text rendering characteristics between Flash 10, Silverlight 4.0 and Photoshop, I created two small applications, one in Flash CS 4, and one in Visual Studio 2010. The Silverlight 4.0 tests are using the release candidate which was current as of March 23, 2010. I used Times New Roman\u2026","rel":"","context":"In &quot;Coding&quot;","img":{"alt_text":"image","src":"https:\/\/i0.wp.com\/www.wiredprairie.us\/blog\/wp-content\/uploads\/2010\/03\/image_thumb.png?resize=350%2C200","width":350,"height":200},"classes":[]},{"id":389,"url":"https:\/\/www.wiredprairie.us\/blog\/index.php\/archives\/389","url_meta":{"origin":634,"position":3},"title":"Silverlight (and Flex), not for LOB applications?","date":"June 27, 2008","format":false,"excerpt":"Shawn suggests that line of business applications should not be written using Silverlight (and hence Flex), instead XBAPs (the run in browser Windows-only WPF solution). IT shops, with trimmed budgets and staff, have little time to maintain workstations and troubleshoot interactions between various installed applications. Web applications, although they may\u2026","rel":"","context":"In &quot;Coding&quot;","img":{"alt_text":"","src":"","width":0,"height":0},"classes":[]},{"id":577,"url":"https:\/\/www.wiredprairie.us\/blog\/index.php\/archives\/577","url_meta":{"origin":634,"position":4},"title":"Silverlight Game Programming: Playing an Audio File","date":"October 12, 2008","format":false,"excerpt":"In my recent Silverlight game, there are a variety of sound effects that occur from bullet fires to explosions. Most of the audio files are brief, lasting only for a second or less on average. I had a few options -- put a MediaElement directly on the UI (in XAML)\u2026","rel":"","context":"In &quot;Coding&quot;","img":{"alt_text":"","src":"https:\/\/i0.wp.com\/www.wiredprairie.us\/blog\/wp-content\/uploads\/2008\/10\/image2.png?resize=350%2C200","width":350,"height":200},"classes":[]},{"id":633,"url":"https:\/\/www.wiredprairie.us\/blog\/index.php\/archives\/633","url_meta":{"origin":634,"position":5},"title":"A Silverlight 2 TilePanel","date":"December 14, 2008","format":false,"excerpt":"You may notice that the Silverlight TileBrush is missing some key properties which would enable it to actually tile a brush. The WPF TileBrush has properties such as TileMode, Viewbox, and ViewportUnits that can be used to tile an image as a fill or as a background for a UIElement.\u2026","rel":"","context":"In &quot;Coding&quot;","img":{"alt_text":"","src":"https:\/\/i0.wp.com\/www.wiredprairie.us\/blog\/wp-content\/uploads\/2008\/12\/image1.png?resize=350%2C200","width":350,"height":200},"classes":[]}],"_links":{"self":[{"href":"https:\/\/www.wiredprairie.us\/blog\/index.php\/wp-json\/wp\/v2\/posts\/634"}],"collection":[{"href":"https:\/\/www.wiredprairie.us\/blog\/index.php\/wp-json\/wp\/v2\/posts"}],"about":[{"href":"https:\/\/www.wiredprairie.us\/blog\/index.php\/wp-json\/wp\/v2\/types\/post"}],"author":[{"embeddable":true,"href":"https:\/\/www.wiredprairie.us\/blog\/index.php\/wp-json\/wp\/v2\/users\/2"}],"replies":[{"embeddable":true,"href":"https:\/\/www.wiredprairie.us\/blog\/index.php\/wp-json\/wp\/v2\/comments?post=634"}],"version-history":[{"count":0,"href":"https:\/\/www.wiredprairie.us\/blog\/index.php\/wp-json\/wp\/v2\/posts\/634\/revisions"}],"wp:attachment":[{"href":"https:\/\/www.wiredprairie.us\/blog\/index.php\/wp-json\/wp\/v2\/media?parent=634"}],"wp:term":[{"taxonomy":"category","embeddable":true,"href":"https:\/\/www.wiredprairie.us\/blog\/index.php\/wp-json\/wp\/v2\/categories?post=634"},{"taxonomy":"post_tag","embeddable":true,"href":"https:\/\/www.wiredprairie.us\/blog\/index.php\/wp-json\/wp\/v2\/tags?post=634"}],"curies":[{"name":"wp","href":"https:\/\/api.w.org\/{rel}","templated":true}]}}