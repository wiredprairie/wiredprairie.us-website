{"id":891,"date":"2010-01-25T21:51:11","date_gmt":"2010-01-26T02:51:11","guid":{"rendered":"http:\/\/www.wiredprairie.us\/blog\/index.php\/archives\/891"},"modified":"2010-01-25T21:51:11","modified_gmt":"2010-01-26T02:51:11","slug":"resource-intensive-wpf-progress-bar-animation","status":"publish","type":"post","link":"https:\/\/www.wiredprairie.us\/blog\/index.php\/archives\/891","title":{"rendered":"Resource Intensive WPF Progress Bar (animation)"},"content":{"rendered":"<p>I\u2019m using a progress bar in a small WPF application I\u2019m working on and noticed that the Private Working Set for my application seemed higher than I expected. <\/p>\n<p>My application, once simplified down to it\u2019s most basic element, consisted of:<\/p>\n<p>Window, Grid, ProgressBar<\/p>\n<p>On my Windows 7 x64 machine, running the application uses around 29MB (private working set).<\/p>\n<p>Removing the <strong>animation <\/strong>only from the visual template drops the private working set to 19MB.<\/p>\n<p>So, it appears that the animation alone causes an extra 10MB of private working set to be needed. Sorry, but that\u2019s crazy (especially for my application)!<\/p>\n<p>If anyone has any specific theories \u2013 speak up! Here&#8217;s the basic starting Window I created:<\/p>\n<pre class=\"code\"><span style=\"color: blue\">&lt;<\/span><span style=\"color: #a31515\">Window\n    <\/span><span style=\"color: red\">xmlns<\/span><span style=\"color: blue\">=&quot;http:\/\/schemas.microsoft.com\/winfx\/2006\/xaml\/presentation&quot;\n    <\/span><span style=\"color: red\">xmlns<\/span><span style=\"color: blue\">:<\/span><span style=\"color: red\">x<\/span><span style=\"color: blue\">=&quot;http:\/\/schemas.microsoft.com\/winfx\/2006\/xaml&quot;\n    <\/span><span style=\"color: red\">xmlns<\/span><span style=\"color: blue\">:<\/span><span style=\"color: red\">Microsoft_Windows_Themes<\/span><span style=\"color: blue\">=&quot;clr-namespace:Microsoft.Windows.Themes;assembly=PresentationFramework.Aero&quot; <\/span><span style=\"color: red\">x<\/span><span style=\"color: blue\">:<\/span><span style=\"color: red\">Class<\/span><span style=\"color: blue\">=&quot;PerfProgressBar.Window1&quot;\n    <\/span><span style=\"color: red\">Title<\/span><span style=\"color: blue\">=&quot;Window1&quot; <\/span><span style=\"color: red\">Height<\/span><span style=\"color: blue\">=&quot;300&quot; <\/span><span style=\"color: red\">Width<\/span><span style=\"color: blue\">=&quot;300&quot;&gt;\n<\/span><span style=\"color: blue\">    &lt;<\/span><span style=\"color: #a31515\">Grid<\/span><span style=\"color: blue\">&gt;\n        &lt;<\/span><span style=\"color: #a31515\">ProgressBar <\/span><span style=\"color: red\">x<\/span><span style=\"color: blue\">:<\/span><span style=\"color: red\">Name<\/span><span style=\"color: blue\">=&quot;progressBar1&quot; <\/span><span style=\"color: red\">Value<\/span><span style=\"color: blue\">=&quot;100&quot; <\/span><span style=\"color: blue\">\/&gt;\n    &lt;\/<\/span><span style=\"color: #a31515\">Grid<\/span><span style=\"color: blue\">&gt;\n&lt;\/<\/span><span style=\"color: #a31515\">Window<\/span><span style=\"color: blue\">&gt;\n<\/span><\/pre>\n<p><a href=\"http:\/\/11011.net\/software\/vspaste\"><\/a><\/p>\n<p>I\u2019m not going to post the entire ProgressBar template, but if you want to reproduce the problem (and see how the animation impacts the memory requirements, just comment out the \u201cAnimation\u201d rectangle in the control template (and in the trigger as well):<\/p>\n<pre class=\"code\"><span style=\"color: blue\">&lt;<\/span><span style=\"color: #a31515\">Rectangle <\/span><span style=\"color: red\">x<\/span><span style=\"color: blue\">:<\/span><span style=\"color: red\">Name<\/span><span style=\"color: blue\">=&quot;Animation&quot; <\/span><span style=\"color: red\">Fill<\/span><span style=\"color: blue\">=&quot;{<\/span><span style=\"color: #a31515\">TemplateBinding <\/span><span style=\"color: red\">Foreground<\/span><span style=\"color: blue\">}&quot; <\/span><span style=\"color: red\">Grid.ColumnSpan<\/span><span style=\"color: blue\">=&quot;3&quot; <\/span><span style=\"color: red\">Grid.RowSpan<\/span><span style=\"color: blue\">=&quot;2&quot;&gt;\n    &lt;<\/span><span style=\"color: #a31515\">Rectangle.OpacityMask<\/span><span style=\"color: blue\">&gt;\n        &lt;<\/span><span style=\"color: #a31515\">MultiBinding<\/span><span style=\"color: blue\">&gt;\n            &lt;<\/span><span style=\"color: #a31515\">MultiBinding.Converter<\/span><span style=\"color: blue\">&gt;\n                &lt;<\/span><span style=\"color: #a31515\">Microsoft_Windows_Themes<\/span><span style=\"color: blue\">:<\/span><span style=\"color: #a31515\">ProgressBarHighlightConverter<\/span><span style=\"color: blue\">\/&gt;\n            &lt;\/<\/span><span style=\"color: #a31515\">MultiBinding.Converter<\/span><span style=\"color: blue\">&gt;\n            &lt;<\/span><span style=\"color: #a31515\">Binding <\/span><span style=\"color: red\">Source<\/span><span style=\"color: blue\">=&quot;{<\/span><span style=\"color: #a31515\">StaticResource <\/span><span style=\"color: red\">ProgressBarIndicatorAnimatedFill<\/span><span style=\"color: blue\">}&quot;\/&gt;\n            &lt;<\/span><span style=\"color: #a31515\">Binding <\/span><span style=\"color: red\">Path<\/span><span style=\"color: blue\">=&quot;ActualWidth&quot; <\/span><span style=\"color: red\">ElementName<\/span><span style=\"color: blue\">=&quot;Background&quot;\/&gt;\n            &lt;<\/span><span style=\"color: #a31515\">Binding <\/span><span style=\"color: red\">Path<\/span><span style=\"color: blue\">=&quot;ActualHeight&quot; <\/span><span style=\"color: red\">ElementName<\/span><span style=\"color: blue\">=&quot;Background&quot;\/&gt;\n        &lt;\/<\/span><span style=\"color: #a31515\">MultiBinding<\/span><span style=\"color: blue\">&gt;\n    &lt;\/<\/span><span style=\"color: #a31515\">Rectangle.OpacityMask<\/span><span style=\"color: blue\">&gt;\n&lt;\/<\/span><span style=\"color: #a31515\">Rectangle<\/span><span style=\"color: blue\">&gt;<\/span><\/pre>\n<p><a href=\"http:\/\/11011.net\/software\/vspaste\"><\/a><\/p>\n<pre class=\"code\"><span style=\"color: blue\">&lt;<\/span><span style=\"color: #a31515\">Trigger <\/span><span style=\"color: red\">Property<\/span><span style=\"color: blue\">=&quot;IsIndeterminate&quot; <\/span><span style=\"color: red\">Value<\/span><span style=\"color: blue\">=&quot;false&quot;&gt;\n    &lt;<\/span><span style=\"color: #a31515\">Setter <\/span><span style=\"color: red\">Property<\/span><span style=\"color: blue\">=&quot;Fill&quot; <\/span><span style=\"color: red\">TargetName<\/span><span style=\"color: blue\">=&quot;Animation&quot; <\/span><span style=\"color: red\">Value<\/span><span style=\"color: blue\">=&quot;#80B5FFA9&quot;\/&gt;\n&lt;\/<\/span><span style=\"color: #a31515\">Trigger<\/span><span style=\"color: blue\">&gt;\n<\/span><\/pre>\n<p>Apparently, the ProgressBarHighlightConverter is intense (a little double checking in Reflector confirms!).<\/p>\n<p>(All animations have some price of course \u2013 as an experiment I rotated the progressbar in a storyboard and that used about 7MB).<\/p>\n<p>The moral of the story here really is to make sure you do some sanity checks against your [fill-in-the-blank] technology so that you understand how it uses system resources such as memory, CPU, etc, as it may have an impact on the success or failure of your application. I\u2019ll leave out the gratuitous animations in my application so it doesn\u2019t use memory unnecessarily.<\/p>\n","protected":false},"excerpt":{"rendered":"<p>I\u2019m using a progress bar in a small WPF application I\u2019m working on and noticed that the Private Working Set for my application seemed higher than I expected. My application, once simplified down to it\u2019s most basic element, consisted of: Window, Grid, ProgressBar On my Windows 7 x64 machine, running the application uses around 29MB [&hellip;]<\/p>\n","protected":false},"author":2,"featured_media":0,"comment_status":"open","ping_status":"open","sticky":false,"template":"","format":"standard","meta":{"spay_email":"","jetpack_publicize_message":"","jetpack_is_tweetstorm":false,"jetpack_publicize_feature_enabled":true},"categories":[4],"tags":[16],"jetpack_publicize_connections":[],"jetpack_featured_media_url":"","jetpack_sharing_enabled":true,"jetpack_shortlink":"https:\/\/wp.me\/pd5QIe-en","jetpack_likes_enabled":true,"jetpack-related-posts":[{"id":1524,"url":"https:\/\/www.wiredprairie.us\/blog\/index.php\/archives\/1524","url_meta":{"origin":891,"position":0},"title":"Alternative to ApplicationSettings in .NET","date":"February 1, 2012","format":false,"excerpt":"After dealing with lost settings, an unclear upgrade path, and my own confusion surrounding the magic of Settings in a .NET client application, I decided to build my own. You\u2019re probably familiar with this UI in Visual Studio. It hasn\u2019t changed much since it was first created: A list of\u2026","rel":"","context":"In &quot;Coding&quot;","img":{"alt_text":"image","src":"https:\/\/i0.wp.com\/www.wiredprairie.us\/blog\/wp-content\/uploads\/2012\/02\/image.png?resize=350%2C200","width":350,"height":200},"classes":[]},{"id":1701,"url":"https:\/\/www.wiredprairie.us\/blog\/index.php\/archives\/1701","url_meta":{"origin":891,"position":1},"title":"Windows 8 WinRT\/Metro Missing UpdateSourceTrigger","date":"August 5, 2012","format":false,"excerpt":"If you\u2019ve done WPF or Silverlight programming, you may have found an occasion where using the Binding property UpdateSourceTrigger set to PropertyChanged was extremely useful. (I know I have!) It may have looked something like this: <TextBox Text=\"{Binding Path=Value, UpdateSourceTrigger=PropertyChanged}\" \/> The key feature was the live updating of the\u2026","rel":"","context":"In &quot;Coding&quot;","img":{"alt_text":"","src":"","width":0,"height":0},"classes":[]},{"id":1705,"url":"https:\/\/www.wiredprairie.us\/blog\/index.php\/archives\/1705","url_meta":{"origin":891,"position":2},"title":"WinRT\/Xaml\/AKA Metro DataTemplate selection based on Data Types","date":"August 20, 2012","format":false,"excerpt":"You may have noticed that WinRT does not have automatic resolution of a DataTemplate based on the data type of object added to an ItemsControl. While unfortunate as this behavior is quite handy, it\u2019s not too difficult to replicate the functionality using a DataTemplateSelector. WPF for example, could do something\u2026","rel":"","context":"In &quot;Coding&quot;","img":{"alt_text":"","src":"","width":0,"height":0},"classes":[]},{"id":902,"url":"https:\/\/www.wiredprairie.us\/blog\/index.php\/archives\/902","url_meta":{"origin":891,"position":3},"title":"Visual Studio 2010 Remote Desktop Performance Tips","date":"March 4, 2010","format":false,"excerpt":"I was disappointed, but certainly not surprised, to see that Microsoft employees blogging that Visual Studio 2010 performance over remote desktop would almost match, or be slightly slower than Visual Studio 2008 performance. However, they got some good advice on how to optimize your RDP experience with Visual Studio. http:\/\/blogs.msdn.com\/jgoldb\/archive\/2010\/02\/27\/optimizing-visual-studio-2010-and-wpf-applications-for-remote-desktop.aspx\u2026","rel":"","context":"In &quot;Coding&quot;","img":{"alt_text":"image","src":"https:\/\/i0.wp.com\/www.wiredprairie.us\/blog\/wp-content\/uploads\/2010\/03\/image.png?resize=350%2C200","width":350,"height":200},"classes":[]},{"id":1449,"url":"https:\/\/www.wiredprairie.us\/blog\/index.php\/archives\/1449","url_meta":{"origin":891,"position":4},"title":".NET API for Nest Thermostat","date":"January 9, 2012","format":false,"excerpt":"I just finished a preliminary read-only (think version 0.1) wrapper around the Nest Thermostat API that is used by their mobile phone and web applications. As Nest doesn\u2019t have a formal API yet, the code could break at any time and may not be suitable for any use. However, it\u2026","rel":"","context":"In &quot;Coding&quot;","img":{"alt_text":"SNAGHTML88bff0b3","src":"https:\/\/i0.wp.com\/www.wiredprairie.us\/blog\/wp-content\/uploads\/2012\/01\/SNAGHTML88bff0b3_thumb.png?resize=350%2C200","width":350,"height":200},"classes":[]},{"id":568,"url":"https:\/\/www.wiredprairie.us\/blog\/index.php\/archives\/568","url_meta":{"origin":891,"position":5},"title":"Data Binding and Tooltips in Silverlight","date":"September 19, 2008","format":false,"excerpt":"Have you ever wanted to databind a tooltip in Silverlight (or WPF for that matter), and found that the DataContext isn't available for tooltips (the datacontext is null)? It's very annoying. Tooltips, unfortunately, aren't connected to their parents in anyway when they're created, so they loose the ability to connect\u2026","rel":"","context":"In &quot;Coding&quot;","img":{"alt_text":"","src":"","width":0,"height":0},"classes":[]}],"_links":{"self":[{"href":"https:\/\/www.wiredprairie.us\/blog\/index.php\/wpjson\/wp\/v2\/posts\/891"}],"collection":[{"href":"https:\/\/www.wiredprairie.us\/blog\/index.php\/wpjson\/wp\/v2\/posts"}],"about":[{"href":"https:\/\/www.wiredprairie.us\/blog\/index.php\/wpjson\/wp\/v2\/types\/post"}],"author":[{"embeddable":true,"href":"https:\/\/www.wiredprairie.us\/blog\/index.php\/wpjson\/wp\/v2\/users\/2"}],"replies":[{"embeddable":true,"href":"https:\/\/www.wiredprairie.us\/blog\/index.php\/wpjson\/wp\/v2\/comments?post=891"}],"version-history":[{"count":1,"href":"https:\/\/www.wiredprairie.us\/blog\/index.php\/wpjson\/wp\/v2\/posts\/891\/revisions"}],"predecessor-version":[{"id":892,"href":"https:\/\/www.wiredprairie.us\/blog\/index.php\/wpjson\/wp\/v2\/posts\/891\/revisions\/892"}],"wp:attachment":[{"href":"https:\/\/www.wiredprairie.us\/blog\/index.php\/wpjson\/wp\/v2\/media?parent=891"}],"wp:term":[{"taxonomy":"category","embeddable":true,"href":"https:\/\/www.wiredprairie.us\/blog\/index.php\/wpjson\/wp\/v2\/categories?post=891"},{"taxonomy":"post_tag","embeddable":true,"href":"https:\/\/www.wiredprairie.us\/blog\/index.php\/wpjson\/wp\/v2\/tags?post=891"}],"curies":[{"name":"wp","href":"https:\/\/api.w.org\/{rel}","templated":true}]}}