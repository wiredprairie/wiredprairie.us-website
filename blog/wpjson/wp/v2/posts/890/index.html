{"id":890,"date":"2010-01-17T13:26:54","date_gmt":"2010-01-17T18:26:54","guid":{"rendered":"http:\/\/www.wiredprairie.us\/blog\/index.php\/archives\/890"},"modified":"2010-01-17T13:26:54","modified_gmt":"2010-01-17T18:26:54","slug":"disabling-automatic-sys-ui-control-attachment","status":"publish","type":"post","link":"https:\/\/www.wiredprairie.us\/blog\/index.php\/archives\/890","title":{"rendered":"Disabling automatic Sys.UI.Control attachment"},"content":{"rendered":"<p>If you\u2019re using the Microsoft Ajax Library (<a href=\"http:\/\/www.asp.net\/ajaxlibrary\/learn.ashx\" target=\"_blank\">learn<\/a>), you may not always want to start the automatic \u201cattach\u201d process that takes place when the page loads. It\u2019s easy to disable, but not yet documented any place I could find easily.<\/p>\n<pre class=\"code\"><span style=\"color: blue\">&lt;<\/span><span style=\"color: #a31515\">script <\/span><span style=\"color: red\">src<\/span><span style=\"color: blue\">=&quot;Scripts\/MicrosoftAjax\/Start.debug.js&quot; <\/span><span style=\"color: red\">type<\/span><span style=\"color: blue\">=&quot;text\/javascript&quot;&gt;&lt;\/<\/span><span style=\"color: #a31515\">script<\/span><span style=\"color: blue\">&gt;\n&lt;<\/span><span style=\"color: #a31515\">script <\/span><span style=\"color: red\">type<\/span><span style=\"color: blue\">=&quot;text\/javascript&quot;&gt;\n\n    var <\/span>ajaxPath = <span style=\"color: #a31515\">&quot;&quot;<\/span>;\n\n    Sys.activateDom = <span style=\"color: blue\">false<\/span>;<\/pre>\n<p>All you must do is set <strong>Sys.activateDom<\/strong> to <strong>false<\/strong> as shown above (make sure this is set <strong>after<\/strong> the new Start.js JavaScript file loads, otherwise your code will crash when you try to set the Sys object before it has been properly constructed). <\/p>\n<p>Then, to begin the attach process, just call <strong>Sys.activateElements<\/strong>:<\/p>\n<pre class=\"code\">Sys.activateElements(document.documentElement);<\/pre>\n<p>In the code line above, though I\u2019ve specified that I want the entire HTML document activated, you could provide any element you want as a starting point (for example to optimize the use of the library and prevent unnecessary DOM searching for example).<\/p>\n<p>I\u2019m adding the delay in some JavaScript code because I wanted to set up a few variables in advance of the attach occurring. I tend to write my JavaScript code in an object oriented fashion these days (using the prototype pattern), including code that is interacting with the DOM. In this case, I\u2019ll create a class that represents the logic of the page rather than following the typical purely functional model that is done on many JavaScript pages. But, when using the \u201c<strong>eval<\/strong>\u201d syntax of the Microsoft Ajax library \u201c{{ code }}\u201d, occasionally, I\u2019ll need to delay the <strong>eval<\/strong> or the page will crash. <\/p>\n<p>From my recent post on making a simple <a href=\"http:\/\/www.wiredprairie.us\/blog\/index.php\/archives\/885\" target=\"_blank\">command extension to the Microsoft Ajax library<\/a>, I wanted to make that more object oriented by referring to an instance of my class, rather than pointing directly to a function:<\/p>\n<pre class=\"code\"><span style=\"color: blue\">&lt;<\/span><span style=\"color: #a31515\">body sys<\/span><span style=\"color: blue\">:<\/span><span style=\"color: red\">attach<\/span><span style=\"color: blue\">=&quot;wpc&quot; \n    <\/span><span style=\"color: #a31515\">wpc<\/span><span style=\"color: blue\">:<\/span><span style=\"color: red\">onbubbleevent<\/span><span style=\"color: blue\">=&quot;{{$view.onCommand}}&quot;  \n    <\/span><span style=\"color: #a31515\">xmlns<\/span><span style=\"color: blue\">:<\/span><span style=\"color: red\">sys<\/span><span style=\"color: blue\">=&quot;javascript:Sys&quot; <\/span><span style=\"color: #a31515\">xmlns<\/span><span style=\"color: blue\">:<\/span><span style=\"color: red\">wpc<\/span><span style=\"color: blue\">=&quot;javascript:WiredPrairie.Commanding&quot;&gt;\n<\/span><\/pre>\n<p><a href=\"http:\/\/11011.net\/software\/vspaste\"><\/a><\/p>\n<p><strong>$view <\/strong>represents the instance of my page\u2019s behavior. However, if the attach were to occur too early, this variable is not yet set. I\u2019m using the slick <a href=\"http:\/\/www.asp.net\/ajaxlibrary\/HOW%20TO%20Load%20a%20Custom%20Script%20with%20Dependencies.ashx\">script loading functionality<\/a> of the ajax library, specifying the various JavaScript libraries and their dependencies, including my page\u2019s behavior. It\u2019s not until that JavaScript code is loaded that the code can create an instance \u2013 and that could be AFTER the page has already done the attach logic. The attach happens before <strong>Sys.onReady<\/strong> for example. (Sys.<strong>onDomReady<\/strong> happens before <strong>onReady<\/strong>, but not all JavaScript files may have been downloaded).<\/p>\n<pre class=\"code\">Sys.onReady(<span style=\"color: blue\">function<\/span>() {\n    $view = <span style=\"color: blue\">new <\/span>WiredPrairie.MainView();\n    \n    Sys.activateElements(document.documentElement);<\/pre>\n<p><a href=\"http:\/\/11011.net\/software\/vspaste\"><\/a><\/p>\n<p>When using the <strong>sys:attach<\/strong> attribute, note that the attach and instantiation process happens <strong>before<\/strong> any code you\u2019ve specified in <strong>onReady<\/strong> is executed (Microsoft currently uses the same method for determining when everything is ready by adding a function call to <strong>onReady<\/strong> \u2013 but their call is first in the queue). <\/p>\n","protected":false},"excerpt":{"rendered":"<p>If you\u2019re using the Microsoft Ajax Library (learn), you may not always want to start the automatic \u201cattach\u201d process that takes place when the page loads. It\u2019s easy to disable, but not yet documented any place I could find easily. &lt;script src=&quot;Scripts\/MicrosoftAjax\/Start.debug.js&quot; type=&quot;text\/javascript&quot;&gt;&lt;\/script&gt; &lt;script type=&quot;text\/javascript&quot;&gt; var ajaxPath = &quot;&quot;; Sys.activateDom = false; All you must [&hellip;]<\/p>\n","protected":false},"author":2,"featured_media":0,"comment_status":"open","ping_status":"open","sticky":false,"template":"","format":"standard","meta":{"spay_email":"","jetpack_publicize_message":"","jetpack_is_tweetstorm":false,"jetpack_publicize_feature_enabled":true},"categories":[4],"tags":[21,22],"jetpack_publicize_connections":[],"jetpack_featured_media_url":"","jetpack_sharing_enabled":true,"jetpack_shortlink":"https:\/\/wp.me\/pd5QIe-em","jetpack_likes_enabled":true,"jetpack-related-posts":[{"id":885,"url":"https:\/\/www.wiredprairie.us\/blog\/index.php\/archives\/885","url_meta":{"origin":890,"position":0},"title":"Microsoft Ajax Library Declarative Command Alternatives","date":"January 3, 2010","format":false,"excerpt":"There may be another way to accomplish this, but I wanted to have a simple commanding system in the Microsoft Ajax Library which worked outside of the templates. After a number of false starts and frustration brought about by very limited documentation, I discovered a reasonable implementation. I created a\u2026","rel":"","context":"In &quot;Coding&quot;","img":{"alt_text":"","src":"","width":0,"height":0},"classes":[]},{"id":1442,"url":"https:\/\/www.wiredprairie.us\/blog\/index.php\/archives\/1442","url_meta":{"origin":890,"position":1},"title":"Nest Thermostat API\/Protocol","date":"January 8, 2012","format":false,"excerpt":"While Nest Labs hasn\u2019t released a formal (documented & supported) API, I thought I\u2019d do a bit of digging to see how they\u2019re using the network and what might be achievable. A few things are going on, the majority as you\u2019d probably expect. The web interface is using a long\u2026","rel":"","context":"In &quot;Coding&quot;","img":{"alt_text":"image","src":"https:\/\/i0.wp.com\/www.wiredprairie.us\/blog\/wp-content\/uploads\/2012\/01\/image_thumb7.png?resize=350%2C200","width":350,"height":200},"classes":[]},{"id":1820,"url":"https:\/\/www.wiredprairie.us\/blog\/index.php\/archives\/1820","url_meta":{"origin":890,"position":2},"title":"Knockout binding for JavaScript route fixup","date":"January 25, 2013","format":false,"excerpt":"Part one. After the first round, I felt compelled to KnockOut the code a bit more. I\u2019d mentioned I wasn\u2019t pleased with the code exactly. It needed some refactoring. So, I\u2019ve created a new Knockout binding handler. This binding handler replaces\u00a0 named parameters with a model\u2019s properties in a path.\u2026","rel":"","context":"In &quot;Coding&quot;","img":{"alt_text":"","src":"","width":0,"height":0},"classes":[]},{"id":1178,"url":"https:\/\/www.wiredprairie.us\/blog\/index.php\/archives\/1178","url_meta":{"origin":890,"position":3},"title":"MSBuild Task Reference and Ajax Minification","date":"February 5, 2011","format":false,"excerpt":"I\u2019m not one for dumping all scripts into a single folder and calling it a day. The template project for ASP.NET MVC 3 does that unfortunately. So, after a bit of cleanup and adding a few more JavaScript libraries that I needed, I\u2019m left with a reasonably organized folder structure.\u2026","rel":"","context":"In &quot;Coding&quot;","img":{"alt_text":"image","src":"https:\/\/i0.wp.com\/www.wiredprairie.us\/blog\/wp-content\/uploads\/2011\/02\/image2.png?resize=350%2C200","width":350,"height":200},"classes":[]},{"id":426,"url":"https:\/\/www.wiredprairie.us\/blog\/index.php\/archives\/426","url_meta":{"origin":890,"position":4},"title":"Visual WebGUI &#8212; Uh? Neat technology for someone else.","date":"July 16, 2008","format":false,"excerpt":"At the top of the page linked above, you can try the Ajax version or the Silverlight version of their web-mail demo. Try it. I won't say that I'm not impressed by what they've accomplished technically. It's impressive. They use a WinForms designer to build parts of the user interface\u2026","rel":"","context":"In &quot;Coding&quot;","img":{"alt_text":"image","src":"https:\/\/i0.wp.com\/www.wiredprairie.us\/blog\/wp-content\/uploads\/2008\/07\/image-thumb2.png?resize=350%2C200","width":350,"height":200},"classes":[]},{"id":871,"url":"https:\/\/www.wiredprairie.us\/blog\/index.php\/archives\/871","url_meta":{"origin":890,"position":5},"title":"Time for JavaScript.NEXT","date":"December 2, 2009","format":false,"excerpt":"OK, I\u2019ll admit that HTML 5, when it becomes a true standard and the common browsers implement it and all of CSS 3 that we won\u2019t need as many browser plug-ins for doing rich interactive applications anymore. We could ditch Microsoft\u2019s Silverlight and Adobe\u2019s Flash and not look back. But,\u2026","rel":"","context":"In &quot;Coding&quot;","img":{"alt_text":"","src":"","width":0,"height":0},"classes":[]}],"_links":{"self":[{"href":"https:\/\/www.wiredprairie.us\/blog\/index.php\/wpjson\/wp\/v2\/posts\/890"}],"collection":[{"href":"https:\/\/www.wiredprairie.us\/blog\/index.php\/wpjson\/wp\/v2\/posts"}],"about":[{"href":"https:\/\/www.wiredprairie.us\/blog\/index.php\/wpjson\/wp\/v2\/types\/post"}],"author":[{"embeddable":true,"href":"https:\/\/www.wiredprairie.us\/blog\/index.php\/wpjson\/wp\/v2\/users\/2"}],"replies":[{"embeddable":true,"href":"https:\/\/www.wiredprairie.us\/blog\/index.php\/wpjson\/wp\/v2\/comments?post=890"}],"version-history":[{"count":0,"href":"https:\/\/www.wiredprairie.us\/blog\/index.php\/wpjson\/wp\/v2\/posts\/890\/revisions"}],"wp:attachment":[{"href":"https:\/\/www.wiredprairie.us\/blog\/index.php\/wpjson\/wp\/v2\/media?parent=890"}],"wp:term":[{"taxonomy":"category","embeddable":true,"href":"https:\/\/www.wiredprairie.us\/blog\/index.php\/wpjson\/wp\/v2\/categories?post=890"},{"taxonomy":"post_tag","embeddable":true,"href":"https:\/\/www.wiredprairie.us\/blog\/index.php\/wpjson\/wp\/v2\/tags?post=890"}],"curies":[{"name":"wp","href":"https:\/\/api.w.org\/{rel}","templated":true}]}}