{"id":670,"date":"2009-01-19T12:47:00","date_gmt":"2009-01-19T17:47:00","guid":{"rendered":"http:\/\/www.wiredprairie.us\/blog\/index.php\/archives\/670"},"modified":"2009-01-19T12:47:00","modified_gmt":"2009-01-19T17:47:00","slug":"silverlight-dynamically-creating-xaml-elements-at-runtime","status":"publish","type":"post","link":"https:\/\/www.wiredprairie.us\/blog\/index.php\/archives\/670","title":{"rendered":"Silverlight: Dynamically creating XAML elements  at runtime"},"content":{"rendered":"<p>Given the following XML file:<\/p>\n<pre class=\"code\"><span style=\"color: blue\">&lt;<\/span><span style=\"color: #a31515\">assets<\/span><span style=\"color: blue\">&gt;\n  &lt;<\/span><span style=\"color: #a31515\">asset name<\/span><span style=\"color: blue\">=<\/span>&quot;<span style=\"color: blue\">tile<\/span>&quot;<span style=\"color: blue\">&gt;\n    &lt;<\/span><span style=\"color: #a31515\">Canvas <\/span><span style=\"color: red\">xmlns<\/span><span style=\"color: blue\">=<\/span>&quot;<span style=\"color: blue\">http:\/\/schemas.microsoft.com\/winfx\/2006\/xaml\/presentation<\/span>&quot; \n            <span style=\"color: red\">xmlns:x<\/span><span style=\"color: blue\">=<\/span>&quot;<span style=\"color: blue\">http:\/\/schemas.microsoft.com\/winfx\/2006\/xaml<\/span>&quot;<span style=\"color: blue\">&gt;\n      &lt;<\/span><span style=\"color: #a31515\">Path <\/span><span style=\"color: red\">x:Name<\/span><span style=\"color: blue\">=<\/span>&quot;<span style=\"color: blue\">top<\/span>&quot; <span style=\"color: red\">Width<\/span><span style=\"color: blue\">=<\/span>&quot;<span style=\"color: blue\">24<\/span>&quot; <span style=\"color: red\">Height<\/span><span style=\"color: blue\">=<\/span>&quot;<span style=\"color: blue\">12<\/span>&quot; <span style=\"color: red\">Stretch<\/span><span style=\"color: blue\">=<\/span>&quot;<span style=\"color: blue\">Fill<\/span>&quot; <span style=\"color: red\">Fill<\/span><span style=\"color: blue\">=<\/span>&quot;<span style=\"color: blue\">#FF065F02<\/span>&quot; \n            <span style=\"color: red\">Stroke<\/span><span style=\"color: blue\">=<\/span>&quot;<span style=\"color: blue\">#10000000<\/span>&quot; <span style=\"color: red\">Data<\/span><span style=\"color: blue\">=<\/span>&quot;<span style=\"color: blue\">F1 M 0,6L 12,12L 24,6L 12,0L 0,6 Z <\/span>&quot;<span style=\"color: blue\">\/&gt;\n    &lt;\/<\/span><span style=\"color: #a31515\">Canvas<\/span><span style=\"color: blue\">&gt;\n  &lt;\/<\/span><span style=\"color: #a31515\">asset<\/span><span style=\"color: blue\">&gt;\n&lt;\/<\/span><span style=\"color: #a31515\">assets<\/span><span style=\"color: blue\">&gt;<\/span><\/pre>\n<p><a href=\"http:\/\/11011.net\/software\/vspaste\"><\/a><\/p>\n<p>It\u2019s easy enough to create reusable assets in Silverlight and load them on demand from XML, and refer to the various pieces that make up the asset by name.<\/p>\n<p>First, add an XML file to your Silverlight project. Set the Build Action to \u201cContent\u201d and the Copy to Output Directory to \u201cDo not copy\u201d. In the example below, it\u2019s \u201cr.xml\u201d. <\/p>\n<p><img loading=\"lazy\" title=\"image\" style=\"border-right: 0px; border-top: 0px; display: inline; border-left: 0px; border-bottom: 0px\" height=\"262\" alt=\"image\" src=\"http:\/\/www.wiredprairie.us\/blog\/wp-content\/uploads\/2009\/01\/image8.png\" width=\"355\" border=\"0\" \/> <\/p>\n<p>Next, add the following methods to a class (probably your UserControl):<\/p>\n<pre class=\"code\"><span style=\"color: blue\">private <\/span><span style=\"color: #2b91af\">Canvas <\/span>CreateXamlAsset(<span style=\"color: blue\">string <\/span>assetName)\n{\n    <span style=\"color: blue\">return <\/span><span style=\"color: #2b91af\">XamlReader<\/span>.Load(LoadAsset(assetName)) <span style=\"color: blue\">as <\/span><span style=\"color: #2b91af\">Canvas<\/span>;\n}\n\n<span style=\"color: blue\">private string <\/span>LoadAsset(<span style=\"color: blue\">string <\/span>assetName)\n{\n    <span style=\"color: blue\">var <\/span>e = <span style=\"color: blue\">from <\/span>a <span style=\"color: blue\">in <\/span><span style=\"color: #2b91af\">XDocument<\/span>.Load(<span style=\"color: #a31515\">&quot;r.xml&quot;<\/span>).Descendants(<span style=\"color: #a31515\">&quot;assets&quot;<\/span>)\n            <span style=\"color: blue\">where <\/span>(<span style=\"color: blue\">string<\/span>) a.Attribute(<span style=\"color: #a31515\">&quot;name&quot;<\/span>) == assetName\n            <span style=\"color: blue\">select <\/span>a.FirstNode;\n    <span style=\"color: blue\">return <\/span>e.First().ToString();\n}<\/pre>\n<p>The code uses LINQ to extract the asset and create it using the XamlReader.Load method. It assumes that the type being returned is a Canvas (it needs to be a container type and for these types of situations I normally use Canvas).<\/p>\n<p>Once the canvas is created, you can call methods such as this:<\/p>\n<pre class=\"code\"><span style=\"color: blue\">private <\/span><span style=\"color: #2b91af\">Shape <\/span>FindShape(<span style=\"color: #2b91af\">Canvas <\/span>c, <span style=\"color: blue\">string <\/span>name)\n{\n    <span style=\"color: blue\">return <\/span>c.FindName(name) <span style=\"color: blue\">as <\/span><span style=\"color: #2b91af\">Shape<\/span>;\n}<\/pre>\n<p><a href=\"http:\/\/11011.net\/software\/vspaste\"><\/a>to locate the named elements within the dynamically created Xaml. For example, given the XAML at the top of this post, I could call the FindShape method like this:<\/p>\n<pre class=\"code\"><span style=\"color: #2b91af\">Shape <\/span>top = FindShape(canvas, <span style=\"color: #a31515\">&quot;top&quot;<\/span>);<\/pre>\n<p><a href=\"http:\/\/11011.net\/software\/vspaste\"><\/a>That would return the Path named \u201ctop&quot; in the XAML. <\/p>\n<p> Make sure that you actually add the asset being returned from CreateXamlAsset to a parent control at some point! :)&#160; <\/p>\n<pre class=\"code\"><span style=\"color: blue\">this<\/span>.Children.Add(canvas);<\/pre>\n<p><a href=\"http:\/\/11011.net\/software\/vspaste\"><\/a><\/p>\n","protected":false},"excerpt":{"rendered":"<p>Given the following XML file: &lt;assets&gt; &lt;asset name=&quot;tile&quot;&gt; &lt;Canvas xmlns=&quot;http:\/\/schemas.microsoft.com\/winfx\/2006\/xaml\/presentation&quot; xmlns:x=&quot;http:\/\/schemas.microsoft.com\/winfx\/2006\/xaml&quot;&gt; &lt;Path x:Name=&quot;top&quot; Width=&quot;24&quot; Height=&quot;12&quot; Stretch=&quot;Fill&quot; Fill=&quot;#FF065F02&quot; Stroke=&quot;#10000000&quot; Data=&quot;F1 M 0,6L 12,12L 24,6L 12,0L 0,6 Z &quot;\/&gt; &lt;\/Canvas&gt; &lt;\/asset&gt; &lt;\/assets&gt; It\u2019s easy enough to create reusable assets in Silverlight and load them on demand from XML, and refer to the various pieces that make up [&hellip;]<\/p>\n","protected":false},"author":2,"featured_media":0,"comment_status":"open","ping_status":"open","sticky":false,"template":"","format":"standard","meta":{"spay_email":"","jetpack_publicize_message":"","jetpack_is_tweetstorm":false,"jetpack_publicize_feature_enabled":true},"categories":[4,14],"tags":[],"jetpack_publicize_connections":[],"jetpack_featured_media_url":"","jetpack_sharing_enabled":true,"jetpack_shortlink":"https:\/\/wp.me\/pd5QIe-aO","jetpack_likes_enabled":true,"jetpack-related-posts":[{"id":388,"url":"https:\/\/www.wiredprairie.us\/blog\/index.php\/archives\/388","url_meta":{"origin":670,"position":0},"title":"Silverlight Weather Demonstration","date":"June 26, 2008","format":false,"excerpt":"Demonstration available here. (You'll need to wait for a moment while it loads the first time). I've created a reasonably simple, yet multi-technology (and discipline) demonstration using Silverlight for the user interface and ASP.NET as the back-end. The demonstration uses: Silverlight 2.0 Data binding Delayed downloading of images \"Web services\"\u2026","rel":"","context":"In &quot;Coding&quot;","img":{"alt_text":"","src":"https:\/\/i0.wp.com\/www.wiredprairie.us\/blog\/wp-content\/uploads\/2008\/06\/image21.png?resize=350%2C200","width":350,"height":200},"classes":[]},{"id":568,"url":"https:\/\/www.wiredprairie.us\/blog\/index.php\/archives\/568","url_meta":{"origin":670,"position":1},"title":"Data Binding and Tooltips in Silverlight","date":"September 19, 2008","format":false,"excerpt":"Have you ever wanted to databind a tooltip in Silverlight (or WPF for that matter), and found that the DataContext isn't available for tooltips (the datacontext is null)? It's very annoying. Tooltips, unfortunately, aren't connected to their parents in anyway when they're created, so they loose the ability to connect\u2026","rel":"","context":"In &quot;Coding&quot;","img":{"alt_text":"","src":"","width":0,"height":0},"classes":[]},{"id":577,"url":"https:\/\/www.wiredprairie.us\/blog\/index.php\/archives\/577","url_meta":{"origin":670,"position":2},"title":"Silverlight Game Programming: Playing an Audio File","date":"October 12, 2008","format":false,"excerpt":"In my recent Silverlight game, there are a variety of sound effects that occur from bullet fires to explosions. Most of the audio files are brief, lasting only for a second or less on average. I had a few options -- put a MediaElement directly on the UI (in XAML)\u2026","rel":"","context":"In &quot;Coding&quot;","img":{"alt_text":"","src":"https:\/\/i0.wp.com\/www.wiredprairie.us\/blog\/wp-content\/uploads\/2008\/10\/image2.png?resize=350%2C200","width":350,"height":200},"classes":[]},{"id":633,"url":"https:\/\/www.wiredprairie.us\/blog\/index.php\/archives\/633","url_meta":{"origin":670,"position":3},"title":"A Silverlight 2 TilePanel","date":"December 14, 2008","format":false,"excerpt":"You may notice that the Silverlight TileBrush is missing some key properties which would enable it to actually tile a brush. The WPF TileBrush has properties such as TileMode, Viewbox, and ViewportUnits that can be used to tile an image as a fill or as a background for a UIElement.\u2026","rel":"","context":"In &quot;Coding&quot;","img":{"alt_text":"","src":"https:\/\/i0.wp.com\/www.wiredprairie.us\/blog\/wp-content\/uploads\/2008\/12\/image1.png?resize=350%2C200","width":350,"height":200},"classes":[]},{"id":1701,"url":"https:\/\/www.wiredprairie.us\/blog\/index.php\/archives\/1701","url_meta":{"origin":670,"position":4},"title":"Windows 8 WinRT\/Metro Missing UpdateSourceTrigger","date":"August 5, 2012","format":false,"excerpt":"If you\u2019ve done WPF or Silverlight programming, you may have found an occasion where using the Binding property UpdateSourceTrigger set to PropertyChanged was extremely useful. (I know I have!) It may have looked something like this: <TextBox Text=\"{Binding Path=Value, UpdateSourceTrigger=PropertyChanged}\" \/> The key feature was the live updating of the\u2026","rel":"","context":"In &quot;Coding&quot;","img":{"alt_text":"","src":"","width":0,"height":0},"classes":[]},{"id":1084,"url":"https:\/\/www.wiredprairie.us\/blog\/index.php\/archives\/1084","url_meta":{"origin":670,"position":5},"title":"Silverlight Analog\/Retro Flip Numbers","date":"June 9, 2010","format":false,"excerpt":"I\u2019m not sure what to call these exactly. I\u2019ve created a relatively simple Silverlight 4 control that emulates the old mechanical flip style numbers (or letters) displays found at airports and in old clock-radios. I call it the RetroFlipper. It\u2019s easy to use (at least for my needs). Declare an\u2026","rel":"","context":"In &quot;Coding&quot;","img":{"alt_text":"image","src":"https:\/\/i0.wp.com\/www.wiredprairie.us\/blog\/wp-content\/uploads\/2010\/06\/image.png?resize=350%2C200","width":350,"height":200},"classes":[]}],"_links":{"self":[{"href":"https:\/\/www.wiredprairie.us\/blog\/index.php\/wpjson\/wp\/v2\/posts\/670"}],"collection":[{"href":"https:\/\/www.wiredprairie.us\/blog\/index.php\/wpjson\/wp\/v2\/posts"}],"about":[{"href":"https:\/\/www.wiredprairie.us\/blog\/index.php\/wpjson\/wp\/v2\/types\/post"}],"author":[{"embeddable":true,"href":"https:\/\/www.wiredprairie.us\/blog\/index.php\/wpjson\/wp\/v2\/users\/2"}],"replies":[{"embeddable":true,"href":"https:\/\/www.wiredprairie.us\/blog\/index.php\/wpjson\/wp\/v2\/comments?post=670"}],"version-history":[{"count":0,"href":"https:\/\/www.wiredprairie.us\/blog\/index.php\/wpjson\/wp\/v2\/posts\/670\/revisions"}],"wp:attachment":[{"href":"https:\/\/www.wiredprairie.us\/blog\/index.php\/wpjson\/wp\/v2\/media?parent=670"}],"wp:term":[{"taxonomy":"category","embeddable":true,"href":"https:\/\/www.wiredprairie.us\/blog\/index.php\/wpjson\/wp\/v2\/categories?post=670"},{"taxonomy":"post_tag","embeddable":true,"href":"https:\/\/www.wiredprairie.us\/blog\/index.php\/wpjson\/wp\/v2\/tags?post=670"}],"curies":[{"name":"wp","href":"https:\/\/api.w.org\/{rel}","templated":true}]}}