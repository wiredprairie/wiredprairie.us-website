{"id":1999,"date":"2014-05-01T19:41:58","date_gmt":"2014-05-02T00:41:58","guid":{"rendered":"http:\/\/www.wiredprairie.us\/blog\/?p=1999"},"modified":"2014-05-01T19:41:58","modified_gmt":"2014-05-02T00:41:58","slug":"ihtmldocument5-and-ihtmldocument6-in-c","status":"publish","type":"post","link":"https:\/\/www.wiredprairie.us\/blog\/index.php\/archives\/1999","title":{"rendered":"IHTMLDocument5 and IHTMLDocument6 in C#"},"content":{"rendered":"<p>Unexpectedly, I found myself needing to use IHTMLDocument5\/6 last evening to fetch a few properties that aren\u2019t directly exposed via any of the Web Browser options in classic .NET programming (like WinForms\/WPF). I couldn\u2019t find them anywhere, so I whipped up something simple\/quick\/dirty:<\/p>\n<pre class=\"csharpcode\">[Guid(<span class=\"str\">&quot;3050f80c-98b5-11cf-bb82-00aa00bdce0b&quot;<\/span>)]\n[InterfaceTypeAttribute(ComInterfaceType.InterfaceIsDual)]\n<span class=\"kwrd\">internal<\/span> <span class=\"kwrd\">interface<\/span> IHTMLDocument5\n{\n    <span class=\"kwrd\">void<\/span> SetOnmousewheel(<span class=\"kwrd\">object<\/span> p);\n    <span class=\"kwrd\">object<\/span> GetOnmousewheel();\n    <span class=\"kwrd\">object<\/span> docType { get; }\n    <span class=\"kwrd\">object<\/span> implementation { get; }\n    <span class=\"kwrd\">object<\/span> createAttribute([In] <span class=\"kwrd\">string<\/span> attrName);\n    <span class=\"kwrd\">object<\/span> createComment([In] <span class=\"kwrd\">string<\/span> comment);\n    <span class=\"kwrd\">void<\/span> SetOnfocusin(<span class=\"kwrd\">object<\/span> p);\n    <span class=\"kwrd\">object<\/span> GetOnfocusin();\n    <span class=\"kwrd\">void<\/span> SetOnfocusout(<span class=\"kwrd\">object<\/span> p);\n    <span class=\"kwrd\">object<\/span> GetOnfocusout();\n    <span class=\"kwrd\">void<\/span> SetOnactivate(<span class=\"kwrd\">object<\/span> p);\n    <span class=\"kwrd\">object<\/span> GetOnactivate();\n    <span class=\"kwrd\">void<\/span> SetOndeactivate(<span class=\"kwrd\">object<\/span> p);\n    <span class=\"kwrd\">object<\/span> GetOndeactivate();\n    <span class=\"kwrd\">void<\/span> SetOnbeforeactivate(<span class=\"kwrd\">object<\/span> p);\n    <span class=\"kwrd\">object<\/span> GetOnbeforeactivate();\n    <span class=\"kwrd\">void<\/span> SetOnbeforedeactivate(<span class=\"kwrd\">object<\/span> p);\n    <span class=\"kwrd\">object<\/span> GetOnbeforedeactivate();\n    <span class=\"kwrd\">string<\/span> compatMode { get; }\n}\n\n\n[Guid(<span class=\"str\">&quot;30510417-98b5-11cf-bb82-00aa00bdce0b&quot;<\/span>)]\n[InterfaceTypeAttribute(ComInterfaceType.InterfaceIsDual)]\n<span class=\"kwrd\">internal<\/span> <span class=\"kwrd\">interface<\/span> IHTMLDocument6\n{\n    <span class=\"kwrd\">object<\/span> compatible { get; }\n    <span class=\"kwrd\">object<\/span> documentMode { get; }\n    <span class=\"kwrd\">void<\/span> SetOnStorage([In] <span class=\"kwrd\">object<\/span> p);\n    <span class=\"kwrd\">object<\/span> GetOnStorage();\n    <span class=\"kwrd\">void<\/span> SetOnStorageCommit([In] <span class=\"kwrd\">object<\/span> p);\n    <span class=\"kwrd\">object<\/span> GetOnStorageCommit();\n    <span class=\"kwrd\">object<\/span> getElementById([In] <span class=\"kwrd\">string<\/span> id);\n    <span class=\"kwrd\">void<\/span> updateSettings();\n}<\/pre>\n<style type=\"text\/css\">\n.csharpcode, .csharpcode pre\n{\n\tfont-size: small;\n\tcolor: black;\n\tfont-family: consolas, \"Courier New\", courier, monospace;\n\tbackground-color: #ffffff;\n\t\/*white-space: pre;*\/\n}\n.csharpcode pre { margin: 0em; }\n.csharpcode .rem { color: #008000; }\n.csharpcode .kwrd { color: #0000ff; }\n.csharpcode .str { color: #006080; }\n.csharpcode .op { color: #0000c0; }\n.csharpcode .preproc { color: #cc6633; }\n.csharpcode .asp { background-color: #ffff00; }\n.csharpcode .html { color: #800000; }\n.csharpcode .attr { color: #ff0000; }\n.csharpcode .alt \n{\n\tbackground-color: #f4f4f4;\n\twidth: 100%;\n\tmargin: 0em;\n}\n.csharpcode .lnum { color: #606060; }<\/style>\n<p>As you can see, I didn\u2019t spend a lot of time with the details, but it was enough to make progress (in particular I wanted <strong>compatMode<\/strong> and <strong>documentMode<\/strong>).<\/p>\n","protected":false},"excerpt":{"rendered":"<p>Unexpectedly, I found myself needing to use IHTMLDocument5\/6 last evening to fetch a few properties that aren\u2019t directly exposed via any of the Web Browser options in classic .NET programming (like WinForms\/WPF). I couldn\u2019t find them anywhere, so I whipped up something simple\/quick\/dirty: [Guid(&quot;3050f80c-98b5-11cf-bb82-00aa00bdce0b&quot;)] [InterfaceTypeAttribute(ComInterfaceType.InterfaceIsDual)] internal interface IHTMLDocument5 { void SetOnmousewheel(object p); object GetOnmousewheel(); object [&hellip;]<\/p>\n","protected":false},"author":2,"featured_media":0,"comment_status":"open","ping_status":"open","sticky":false,"template":"","format":"standard","meta":{"spay_email":"","jetpack_publicize_message":"","jetpack_is_tweetstorm":false,"jetpack_publicize_feature_enabled":true},"categories":[4],"tags":[55,151],"jetpack_publicize_connections":[],"jetpack_featured_media_url":"","jetpack_sharing_enabled":true,"jetpack_shortlink":"https:\/\/wp.me\/pd5QIe-wf","jetpack_likes_enabled":true,"jetpack-related-posts":[{"id":568,"url":"https:\/\/www.wiredprairie.us\/blog\/index.php\/archives\/568","url_meta":{"origin":1999,"position":0},"title":"Data Binding and Tooltips in Silverlight","date":"September 19, 2008","format":false,"excerpt":"Have you ever wanted to databind a tooltip in Silverlight (or WPF for that matter), and found that the DataContext isn't available for tooltips (the datacontext is null)? It's very annoying. Tooltips, unfortunately, aren't connected to their parents in anyway when they're created, so they loose the ability to connect\u2026","rel":"","context":"In &quot;Coding&quot;","img":{"alt_text":"","src":"","width":0,"height":0},"classes":[]},{"id":331,"url":"https:\/\/www.wiredprairie.us\/blog\/index.php\/archives\/331","url_meta":{"origin":1999,"position":1},"title":"Velocity &#8212; a rockin&#8217; distributed in memory cache for ASP.NET","date":"June 3, 2008","format":false,"excerpt":"Velocity, the code-name for a new in-memory distributed caching system for ASP.NET was released as a Community Tech Preview today. What is it? It's described in the documentation: Microsoft project code named \"Velocity\" provides a highly scalable in-memory application cache for all kinds of data. By using cache, your application\u2026","rel":"","context":"In &quot;Coding&quot;","img":{"alt_text":"image","src":"https:\/\/i0.wp.com\/www.wiredprairie.us\/blog\/wp-content\/uploads\/2008\/06\/image-thumb.png?resize=350%2C200","width":350,"height":200},"classes":[]},{"id":1113,"url":"https:\/\/www.wiredprairie.us\/blog\/index.php\/archives\/1113","url_meta":{"origin":1999,"position":2},"title":"How to bind ListBoxItem.IsSelected to a bound item in Silverlight 4.0","date":"July 26, 2010","format":false,"excerpt":"This technique requires the Blend 4.0 SDK (which is included in Blend 4.0 and is also available as a free download. Someone on StackOverflow asked how to bind a collection of items to a ListBox in Silverlight where the IsSelected property of the ListBoxItem is bound to an IsSelected property\u2026","rel":"","context":"In &quot;Coding&quot;","img":{"alt_text":"","src":"https:\/\/i0.wp.com\/www.wiredprairie.us\/blog\/wp-content\/uploads\/2010\/07\/image2.png?resize=350%2C200","width":350,"height":200},"classes":[]},{"id":1705,"url":"https:\/\/www.wiredprairie.us\/blog\/index.php\/archives\/1705","url_meta":{"origin":1999,"position":3},"title":"WinRT\/Xaml\/AKA Metro DataTemplate selection based on Data Types","date":"August 20, 2012","format":false,"excerpt":"You may have noticed that WinRT does not have automatic resolution of a DataTemplate based on the data type of object added to an ItemsControl. While unfortunate as this behavior is quite handy, it\u2019s not too difficult to replicate the functionality using a DataTemplateSelector. WPF for example, could do something\u2026","rel":"","context":"In &quot;Coding&quot;","img":{"alt_text":"","src":"","width":0,"height":0},"classes":[]},{"id":1216,"url":"https:\/\/www.wiredprairie.us\/blog\/index.php\/archives\/1216","url_meta":{"origin":1999,"position":4},"title":"Sending an email using SMTP in .NET 4.0","date":"July 13, 2011","format":false,"excerpt":"I had need of sending embedded images within an e-mail. .NET has had a few handy classes for sending an email using SMTP for a few versions. While there were a few examples floating around the internet, none were as clean and easy to follow as I expected. So, I\u2026","rel":"","context":"In &quot;Coding&quot;","img":{"alt_text":"","src":"","width":0,"height":0},"classes":[]},{"id":388,"url":"https:\/\/www.wiredprairie.us\/blog\/index.php\/archives\/388","url_meta":{"origin":1999,"position":5},"title":"Silverlight Weather Demonstration","date":"June 26, 2008","format":false,"excerpt":"Demonstration available here. (You'll need to wait for a moment while it loads the first time). I've created a reasonably simple, yet multi-technology (and discipline) demonstration using Silverlight for the user interface and ASP.NET as the back-end. The demonstration uses: Silverlight 2.0 Data binding Delayed downloading of images \"Web services\"\u2026","rel":"","context":"In &quot;Coding&quot;","img":{"alt_text":"","src":"https:\/\/i0.wp.com\/www.wiredprairie.us\/blog\/wp-content\/uploads\/2008\/06\/image21.png?resize=350%2C200","width":350,"height":200},"classes":[]}],"_links":{"self":[{"href":"https:\/\/www.wiredprairie.us\/blog\/index.php\/wpjson\/wp\/v2\/posts\/1999"}],"collection":[{"href":"https:\/\/www.wiredprairie.us\/blog\/index.php\/wpjson\/wp\/v2\/posts"}],"about":[{"href":"https:\/\/www.wiredprairie.us\/blog\/index.php\/wpjson\/wp\/v2\/types\/post"}],"author":[{"embeddable":true,"href":"https:\/\/www.wiredprairie.us\/blog\/index.php\/wpjson\/wp\/v2\/users\/2"}],"replies":[{"embeddable":true,"href":"https:\/\/www.wiredprairie.us\/blog\/index.php\/wpjson\/wp\/v2\/comments?post=1999"}],"version-history":[{"count":1,"href":"https:\/\/www.wiredprairie.us\/blog\/index.php\/wpjson\/wp\/v2\/posts\/1999\/revisions"}],"predecessor-version":[{"id":2000,"href":"https:\/\/www.wiredprairie.us\/blog\/index.php\/wpjson\/wp\/v2\/posts\/1999\/revisions\/2000"}],"wp:attachment":[{"href":"https:\/\/www.wiredprairie.us\/blog\/index.php\/wpjson\/wp\/v2\/media?parent=1999"}],"wp:term":[{"taxonomy":"category","embeddable":true,"href":"https:\/\/www.wiredprairie.us\/blog\/index.php\/wpjson\/wp\/v2\/categories?post=1999"},{"taxonomy":"post_tag","embeddable":true,"href":"https:\/\/www.wiredprairie.us\/blog\/index.php\/wpjson\/wp\/v2\/tags?post=1999"}],"curies":[{"name":"wp","href":"https:\/\/api.w.org\/{rel}","templated":true}]}}