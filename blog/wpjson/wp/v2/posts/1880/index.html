{"id":1880,"date":"2013-03-28T19:54:53","date_gmt":"2013-03-29T00:54:53","guid":{"rendered":"http:\/\/www.wiredprairie.us\/blog\/?p=1880"},"modified":"2013-03-28T19:54:54","modified_gmt":"2013-03-29T00:54:54","slug":"using-windows-cscript-to-compile-a-handlebar-js-template","status":"publish","type":"post","link":"https:\/\/www.wiredprairie.us\/blog\/index.php\/archives\/1880","title":{"rendered":"Using Windows CSCRIPT to compile a Handlebar.js template"},"content":{"rendered":"<p>I was looking for an alternative to using Node.JS for a JavaScript build process today on a Windows machine. I wanted something that relied as much on natively installed elements of a modern Windows PC as possible so that the build process would be portable.<\/p>\n<p>So, I broke out my rusty <a href=\"http:\/\/msdn.microsoft.com\/en-us\/library\/9bbdkx3k(v=vs.84).aspx\" target=\"_blank\">Windows Script Host<\/a> skills.<\/p>\n<p>First, I created a file called, <strong>compile.wsf <\/strong>with the following contents:<\/p>\n<p><a href=\"http:\/\/www.wiredprairie.us\/blog\/wp-content\/uploads\/2013\/03\/image9.png\"><img loading=\"lazy\" title=\"image\" style=\"border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; float: none; padding-top: 0px; padding-left: 0px; margin: 0px auto; border-left: 0px; display: block; padding-right: 0px\" border=\"0\" alt=\"image\" src=\"http:\/\/www.wiredprairie.us\/blog\/wp-content\/uploads\/2013\/03\/image_thumb8.png\" width=\"548\" height=\"186\" \/><\/a><\/p>\n<p>When using <strong>cscript.exe<\/strong>, you can execute a more complex combination of scripts and include other script files by using a <a href=\"http:\/\/msdn.microsoft.com\/en-us\/library\/15x4407c(v=vs.84).aspx\" target=\"_blank\">Windows Script File<\/a>. The content of the file is an XML definition of jobs. A job represents a unit of work. If you only have one job in a file, the name won\u2019t matter as the script engine will select it by default. If you do have more than one job you\u2019d like to store in a single WSF file, you can use the <strong>\/Job:{id}<\/strong> parameter of <strong>cscript.exe<\/strong> to run a single job.<\/p>\n<p> Using the WSF file, you can include other script files using a script element (much like the script tag in HTML). In the example above, I\u2019ve referenced a local copy of <strong>handlebars.js<\/strong> and a custom script called <strong>compile.js<\/strong>.<\/p>\n<p>You can also inline script as shown above. After doing a basic check on the number of arguments provided to the script, <strong>compile<\/strong> is called, which is from the <strong>compile.js<\/strong> script reference.<\/p>\n<p><strong>Compile.js<\/strong> is simple:<\/p>\n<p><a href=\"http:\/\/www.wiredprairie.us\/blog\/wp-content\/uploads\/2013\/03\/image10.png\"><img loading=\"lazy\" title=\"image\" style=\"border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; float: none; padding-top: 0px; padding-left: 0px; margin: 0px auto; border-left: 0px; display: block; padding-right: 0px\" border=\"0\" alt=\"image\" src=\"http:\/\/www.wiredprairie.us\/blog\/wp-content\/uploads\/2013\/03\/image_thumb9.png\" width=\"539\" height=\"320\" \/><\/a><\/p>\n<p>Using an instance of the <a href=\"http:\/\/msdn.microsoft.com\/en-us\/library\/6kxy1a51(v=vs.84).aspx\" target=\"_blank\">FileSystemObject<\/a>, first the input file is verified to exist. Next, both the input and output files are opened. The Handlebars object is available globally by including it in the WSF definition and is used to precompile the contents of the input file\u2019s template definition. Once compiled, it\u2019s written to the output file and both files are closed.<\/p>\n<p>I threw the three files in a folder called <strong>lib<\/strong>, and created a simple batch file called handlebars.bat which called the cscript executable with the Windows Script File shown above as the first parameter and then the values of the other parameters passed along:<\/p>\n<p><a href=\"http:\/\/www.wiredprairie.us\/blog\/wp-content\/uploads\/2013\/03\/image11.png\"><img loading=\"lazy\" title=\"image\" style=\"border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; float: none; padding-top: 0px; padding-left: 0px; margin: 0px auto; border-left: 0px; display: block; padding-right: 0px\" border=\"0\" alt=\"image\" src=\"http:\/\/www.wiredprairie.us\/blog\/wp-content\/uploads\/2013\/03\/image_thumb10.png\" width=\"238\" height=\"22\" \/><\/a><\/p>\n<p>While this solution only works on Windows, it doesn\u2019t hurt to keep the Windows Script Host in mind when throwing together general repeatable tasks that you:<\/p>\n<ul>\n<li>consider too complex for a batch file<\/li>\n<li>consider too simple for a full .NET application<\/li>\n<li>require usage of existing JavaScript libraries, like Handlebars.js for some work<\/li>\n<\/ul>\n","protected":false},"excerpt":{"rendered":"<p>I was looking for an alternative to using Node.JS for a JavaScript build process today on a Windows machine. I wanted something that relied as much on natively installed elements of a modern Windows PC as possible so that the build process would be portable. So, I broke out my rusty Windows Script Host skills. [&hellip;]<\/p>\n","protected":false},"author":2,"featured_media":0,"comment_status":"open","ping_status":"open","sticky":false,"template":"","format":"standard","meta":{"spay_email":"","jetpack_publicize_message":"","jetpack_is_tweetstorm":false,"jetpack_publicize_feature_enabled":true},"categories":[4,5],"tags":[141,38,140],"jetpack_publicize_connections":[],"jetpack_featured_media_url":"","jetpack_sharing_enabled":true,"jetpack_shortlink":"https:\/\/wp.me\/pd5QIe-uk","jetpack_likes_enabled":true,"jetpack-related-posts":[{"id":1178,"url":"https:\/\/www.wiredprairie.us\/blog\/index.php\/archives\/1178","url_meta":{"origin":1880,"position":0},"title":"MSBuild Task Reference and Ajax Minification","date":"February 5, 2011","format":false,"excerpt":"I\u2019m not one for dumping all scripts into a single folder and calling it a day. The template project for ASP.NET MVC 3 does that unfortunately. So, after a bit of cleanup and adding a few more JavaScript libraries that I needed, I\u2019m left with a reasonably organized folder structure.\u2026","rel":"","context":"In &quot;Coding&quot;","img":{"alt_text":"image","src":"https:\/\/i0.wp.com\/www.wiredprairie.us\/blog\/wp-content\/uploads\/2011\/02\/image2.png?resize=350%2C200","width":350,"height":200},"classes":[]},{"id":2165,"url":"https:\/\/www.wiredprairie.us\/blog\/index.php\/archives\/2165","url_meta":{"origin":1880,"position":1},"title":"Automatic Reconnection of iSCSI Targets in Windows 10 using PowerShell","date":"April 4, 2017","format":false,"excerpt":"When my highly recommended Synology Disk Station reboots for a required update (I've got it set to automatically reboot), a shared Windows 10 PC in our house cannot always successfully reconnect to the iSCSI targets without manual intervention. Unfortunately, I haven't always noticed which has led to several features of\u2026","rel":"","context":"In &quot;Coding&quot;","img":{"alt_text":"","src":"https:\/\/i0.wp.com\/www.wiredprairie.us\/blog\/wp-content\/uploads\/2017\/04\/2017-04-04_19-07-23.png?resize=350%2C200","width":350,"height":200},"classes":[]},{"id":1541,"url":"https:\/\/www.wiredprairie.us\/blog\/index.php\/archives\/1541","url_meta":{"origin":1880,"position":2},"title":"Adobe Lightroom and exporting to subfolders","date":"February 8, 2012","format":false,"excerpt":"For some reason, versions 1 \u2013 3 of Adobe Lightroom cannot export images in a way that mirrors the original structure of your photo library. I can\u2019t offer a reason why other than it was missed by the development and design teams. There\u2019s been enough interest in it apparently that\u2026","rel":"","context":"In &quot;Photography&quot;","img":{"alt_text":"image","src":"https:\/\/i0.wp.com\/www.wiredprairie.us\/blog\/wp-content\/uploads\/2012\/02\/image2.png?resize=350%2C200","width":350,"height":200},"classes":[]},{"id":175,"url":"https:\/\/www.wiredprairie.us\/blog\/index.php\/archives\/175","url_meta":{"origin":1880,"position":3},"title":"What&#8217;s the perfect API?","date":"May 5, 2008","format":false,"excerpt":"I was skimming a rant by someone on arstechnica about how badly messed up Win32 APIs are and how superior everything else is, when this paragraph grabbed my attention: The reason must be that no one in Microsoft actually gives a damn. Each group develops their own UI widgets in\u2026","rel":"","context":"In &quot;Coding&quot;","img":{"alt_text":"","src":"","width":0,"height":0},"classes":[]},{"id":368,"url":"https:\/\/www.wiredprairie.us\/blog\/index.php\/archives\/368","url_meta":{"origin":1880,"position":4},"title":"Do we really need another Javascript framework for UI?","date":"June 16, 2008","format":false,"excerpt":"From the web site, RoughlyDrafted magazine, Cocoa for Windows + Flash Killer = SproutCore. Apple doesn\u2019t sell ads, it sells hardware. But if the web requires Flash or Silverlight to run, Adobe or Microsoft can either intentionally kill alternative platforms like the Mac (or Linux), or simply make them work\u2026","rel":"","context":"In &quot;Coding&quot;","img":{"alt_text":"","src":"","width":0,"height":0},"classes":[]},{"id":1773,"url":"https:\/\/www.wiredprairie.us\/blog\/index.php\/archives\/1773","url_meta":{"origin":1880,"position":5},"title":"AV Club \/ Our home setup 2012","date":"December 12, 2012","format":false,"excerpt":"I\u2019ve done a lot of reworking of our computers and network recently and thought I\u2019d post some details about the various physical and digital parts that make our humble WiredPrairie home work. Using Google Docs, I created a labeled diagram with most of the moving parts of our house (WOW,\u2026","rel":"","context":"In &quot;Recommendations&quot;","img":{"alt_text":"Home Setup","src":"https:\/\/i0.wp.com\/www.wiredprairie.us\/blog\/wp-content\/uploads\/2012\/12\/Home-Setup_thumb1.png?resize=350%2C200","width":350,"height":200},"classes":[]}],"_links":{"self":[{"href":"https:\/\/www.wiredprairie.us\/blog\/index.php\/wp-json\/wp\/v2\/posts\/1880"}],"collection":[{"href":"https:\/\/www.wiredprairie.us\/blog\/index.php\/wp-json\/wp\/v2\/posts"}],"about":[{"href":"https:\/\/www.wiredprairie.us\/blog\/index.php\/wp-json\/wp\/v2\/types\/post"}],"author":[{"embeddable":true,"href":"https:\/\/www.wiredprairie.us\/blog\/index.php\/wp-json\/wp\/v2\/users\/2"}],"replies":[{"embeddable":true,"href":"https:\/\/www.wiredprairie.us\/blog\/index.php\/wp-json\/wp\/v2\/comments?post=1880"}],"version-history":[{"count":0,"href":"https:\/\/www.wiredprairie.us\/blog\/index.php\/wp-json\/wp\/v2\/posts\/1880\/revisions"}],"wp:attachment":[{"href":"https:\/\/www.wiredprairie.us\/blog\/index.php\/wp-json\/wp\/v2\/media?parent=1880"}],"wp:term":[{"taxonomy":"category","embeddable":true,"href":"https:\/\/www.wiredprairie.us\/blog\/index.php\/wp-json\/wp\/v2\/categories?post=1880"},{"taxonomy":"post_tag","embeddable":true,"href":"https:\/\/www.wiredprairie.us\/blog\/index.php\/wp-json\/wp\/v2\/tags?post=1880"}],"curies":[{"name":"wp","href":"https:\/\/api.w.org\/{rel}","templated":true}]}}