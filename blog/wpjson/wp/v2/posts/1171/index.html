{"id":1171,"date":"2011-02-02T22:00:23","date_gmt":"2011-02-03T03:00:23","guid":{"rendered":"http:\/\/www.wiredprairie.us\/blog\/index.php\/archives\/1171"},"modified":"2011-02-03T20:52:58","modified_gmt":"2011-02-04T01:52:58","slug":"translating-controller-action-and-route-data-to-a-javascript-object-in-asp-net-mvc-3","status":"publish","type":"post","link":"https:\/\/www.wiredprairie.us\/blog\/index.php\/archives\/1171","title":{"rendered":"Translating Controller, Action, and Route Data to a JavaScript Object in ASP.NET MVC 3"},"content":{"rendered":"<p>To enable a more rich JavaScript\/Ajax experience on a web page, I had need of more detailed information regarding the route that resulted in the current View being displayed. I checked around a few sites, and nothing popped out as obviously awesome. <\/p>\n<p>As I was putting the JavaScript in the Layout\/Master page, I had few direct assumptions about the location of the View\/route that was currently being executed.<\/p>\n<p>Here are the two options I created this evening.<\/p>\n<p>Option one is admittedly more limited, but it serves to demonstrate the basic technique:<\/p>\n<pre class=\"code\"><span style=\"color: blue\">&lt;<\/span><span style=\"color: maroon\">script <\/span><span style=\"color: red\">type<\/span><span style=\"color: blue\">=&quot;text\/javascript&quot;&gt;\n        \n    <\/span>var _servedFromUrl = &quot;<span style=\"background: yellow\">@<\/span>Url.RouteUrl(<span style=\"color: blue\">this<\/span>.ViewContext.RouteData.Values)&quot;;\n    <span style=\"background: yellow\">@{<\/span> \n        <span style=\"color: blue\">string <\/span>action = ViewContext.RouteData.Values[<span style=\"color: #a31515\">&quot;action&quot;<\/span>].ToString();\n        <span style=\"color: blue\">string <\/span>controller = ViewContext.RouteData.Values[<span style=\"color: #a31515\">&quot;controller&quot;<\/span>].ToString();\n    <span style=\"background: yellow\">}\n<\/span>    var action = &quot;<span style=\"background: yellow\">@<\/span>action&quot;;\n    var controller = &quot;<span style=\"background: yellow\">@<\/span>controller&quot;;\n    \n<span style=\"color: blue\">&lt;\/<\/span><span style=\"color: maroon\">script<\/span><span style=\"color: blue\">&gt;\n<\/span><\/pre>\n<p>Note that the code above is contained within a &lt;script&gt; block, as the final destination goal is to make these values available within JavaScript in the browser.<\/p>\n<p>Above, there are actually 2 different options. The first option, results in a string that could look something like this:<\/p>\n<p><strong>\/Discussions\/Edit\/5522<\/strong><\/p>\n<p>It could be useful to someone. However, it wasn\u2019t useful to me. The next step was to discretely retrieve the action and controller. As you can see, these result in two JavaScript variables, aptly named, <strong>action<\/strong> and <strong>controller<\/strong>. <\/p>\n<pre class=\"code\">var action = &quot;Edit&quot;;\nvar controller = &quot;Discussions&quot;;<\/pre>\n<p>In this case though, I wanted access to all the values, in a more natural JavaScript format: A JavaScript Object with named (ad-hoc) properties.<\/p>\n<pre class=\"code\"><span style=\"color: blue\">&lt;<\/span><span style=\"color: maroon\">script <\/span><span style=\"color: red\">type<\/span><span style=\"color: blue\">=&quot;text\/javascript&quot;&gt;        \n    var <\/span>route = {\n        <span style=\"background: yellow\">@{<\/span>                 \n            <span style=\"color: blue\">string <\/span>comma = <span style=\"color: #a31515\">&quot;&quot;<\/span>;\n            <span style=\"color: blue\">foreach <\/span>(<span style=\"color: blue\">var <\/span>name <span style=\"color: blue\">in <\/span>ViewContext.RouteData.Values.Keys)\n            { \n                <span style=\"color: blue\">string <\/span>val = ViewContext.RouteData.Values[name].ToString();\n                <span style=\"background: yellow\">@:<\/span> <span style=\"background: yellow\">@<\/span>comma<span style=\"color: maroon\">'<\/span><span style=\"background: yellow; color: maroon\">@<\/span>name<span style=\"color: maroon\">'<\/span>: <span style=\"color: maroon\">'<\/span><span style=\"background: yellow; color: maroon\">@<\/span>val<span style=\"color: maroon\">'\n                <\/span>comma = <span style=\"color: #a31515\">&quot;,&quot;<\/span>;\n            }    \n        <span style=\"background: yellow\">}<\/span>                   \n        };\n<span style=\"color: blue\">&lt;\/<\/span><span style=\"color: maroon\">script<\/span><span style=\"color: blue\">&gt;<\/span><\/pre>\n<p>The code above loops through all of the RouteData Keys, and adds each and the corresponding value to a JavaScript object instance named <strong>route<\/strong>. <\/p>\n<p>The results:<\/p>\n<pre class=\"code\"><span style=\"color: blue\">&lt;<\/span><span style=\"color: maroon\">script <\/span><span style=\"color: red\">type<\/span><span style=\"color: blue\">=&quot;text\/javascript&quot;&gt;\n    var <\/span>route = {&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style=\"color: maroon\">'id'<\/span>: <span style=\"color: maroon\">'5522'\n                 <\/span>, <span style=\"color: maroon\">'action'<\/span>: <span style=\"color: maroon\">'Edit'\n                 <\/span>, <span style=\"color: maroon\">'controller'<\/span>: <span style=\"color: maroon\">'Discussion'\n    <\/span>};\n\n<span style=\"color: blue\">&lt;\/<\/span><span style=\"color: maroon\">script<\/span><span style=\"color: blue\">&gt;\n<\/span><\/pre>\n<p>Simple, with discrete values.<\/p>\n","protected":false},"excerpt":{"rendered":"<p>To enable a more rich JavaScript\/Ajax experience on a web page, I had need of more detailed information regarding the route that resulted in the current View being displayed. I checked around a few sites, and nothing popped out as obviously awesome. As I was putting the JavaScript in the Layout\/Master page, I had few [&hellip;]<\/p>\n","protected":false},"author":2,"featured_media":0,"comment_status":"open","ping_status":"open","sticky":false,"template":"","format":"standard","meta":{"spay_email":"","jetpack_publicize_message":"","jetpack_is_tweetstorm":false,"jetpack_publicize_feature_enabled":true},"categories":[4],"tags":[35],"jetpack_publicize_connections":[],"jetpack_featured_media_url":"","jetpack_sharing_enabled":true,"jetpack_shortlink":"https:\/\/wp.me\/pd5QIe-iT","jetpack_likes_enabled":true,"jetpack-related-posts":[{"id":1820,"url":"https:\/\/www.wiredprairie.us\/blog\/index.php\/archives\/1820","url_meta":{"origin":1171,"position":0},"title":"Knockout binding for JavaScript route fixup","date":"January 25, 2013","format":false,"excerpt":"Part one. After the first round, I felt compelled to KnockOut the code a bit more. I\u2019d mentioned I wasn\u2019t pleased with the code exactly. It needed some refactoring. So, I\u2019ve created a new Knockout binding handler. This binding handler replaces\u00a0 named parameters with a model\u2019s properties in a path.\u2026","rel":"","context":"In &quot;Coding&quot;","img":{"alt_text":"","src":"","width":0,"height":0},"classes":[]},{"id":1800,"url":"https:\/\/www.wiredprairie.us\/blog\/index.php\/archives\/1800","url_meta":{"origin":1171,"position":1},"title":"Named routing with Knockout, ASP.NET MVC, and AttributeRouting, from JavaScript","date":"January 24, 2013","format":false,"excerpt":"It's hard to describe exactly what I've built here, but I'm just throwing these pieces out on the Internet in case someone: a) finds them useful, or b) has a better solution. Goals: Named routes, with a wee bit of a Rails feel A Knockout friendly syntax for binding to\u2026","rel":"","context":"In &quot;Coding&quot;","img":{"alt_text":"","src":"","width":0,"height":0},"classes":[]},{"id":1178,"url":"https:\/\/www.wiredprairie.us\/blog\/index.php\/archives\/1178","url_meta":{"origin":1171,"position":2},"title":"MSBuild Task Reference and Ajax Minification","date":"February 5, 2011","format":false,"excerpt":"I\u2019m not one for dumping all scripts into a single folder and calling it a day. The template project for ASP.NET MVC 3 does that unfortunately. So, after a bit of cleanup and adding a few more JavaScript libraries that I needed, I\u2019m left with a reasonably organized folder structure.\u2026","rel":"","context":"In &quot;Coding&quot;","img":{"alt_text":"image","src":"https:\/\/i0.wp.com\/www.wiredprairie.us\/blog\/wp-content\/uploads\/2011\/02\/image2.png?resize=350%2C200","width":350,"height":200},"classes":[]},{"id":885,"url":"https:\/\/www.wiredprairie.us\/blog\/index.php\/archives\/885","url_meta":{"origin":1171,"position":3},"title":"Microsoft Ajax Library Declarative Command Alternatives","date":"January 3, 2010","format":false,"excerpt":"There may be another way to accomplish this, but I wanted to have a simple commanding system in the Microsoft Ajax Library which worked outside of the templates. After a number of false starts and frustration brought about by very limited documentation, I discovered a reasonable implementation. I created a\u2026","rel":"","context":"In &quot;Coding&quot;","img":{"alt_text":"","src":"","width":0,"height":0},"classes":[]},{"id":1442,"url":"https:\/\/www.wiredprairie.us\/blog\/index.php\/archives\/1442","url_meta":{"origin":1171,"position":4},"title":"Nest Thermostat API\/Protocol","date":"January 8, 2012","format":false,"excerpt":"While Nest Labs hasn\u2019t released a formal (documented & supported) API, I thought I\u2019d do a bit of digging to see how they\u2019re using the network and what might be achievable. A few things are going on, the majority as you\u2019d probably expect. The web interface is using a long\u2026","rel":"","context":"In &quot;Coding&quot;","img":{"alt_text":"image","src":"https:\/\/i0.wp.com\/www.wiredprairie.us\/blog\/wp-content\/uploads\/2012\/01\/image_thumb7.png?resize=350%2C200","width":350,"height":200},"classes":[]},{"id":1183,"url":"https:\/\/www.wiredprairie.us\/blog\/index.php\/archives\/1183","url_meta":{"origin":1171,"position":5},"title":"Derserializing ASP.NET MVC JSON formatted Date strings","date":"February 6, 2011","format":false,"excerpt":"Have you called an Ajax based action in MVC, only to find that the Date format is being serialized into something that isn\u2019t entirely useful on the client? {\"result\":[{\"Author\":\"Aaron\",\"SentAt\":\"\\\/Date(1296824894700)\\\/\",\"Text\":\"Blah Blah\",\"Id\":1}],\"runAt\":\"\\\/Date(1297031297600)\\\/\"} You\u2019ll see that the Date is: \\\/Date(1296824894700)\\\/ Alas, that\u2019s not very friendly. For a quick translation, I added the following\u2026","rel":"","context":"In &quot;Coding&quot;","img":{"alt_text":"SNAGHTML51b4c85a","src":"https:\/\/i0.wp.com\/www.wiredprairie.us\/blog\/wp-content\/uploads\/2011\/02\/SNAGHTML51b4c85a.png?resize=350%2C200","width":350,"height":200},"classes":[]}],"_links":{"self":[{"href":"https:\/\/www.wiredprairie.us\/blog\/index.php\/wpjson\/wp\/v2\/posts\/1171"}],"collection":[{"href":"https:\/\/www.wiredprairie.us\/blog\/index.php\/wpjson\/wp\/v2\/posts"}],"about":[{"href":"https:\/\/www.wiredprairie.us\/blog\/index.php\/wpjson\/wp\/v2\/types\/post"}],"author":[{"embeddable":true,"href":"https:\/\/www.wiredprairie.us\/blog\/index.php\/wpjson\/wp\/v2\/users\/2"}],"replies":[{"embeddable":true,"href":"https:\/\/www.wiredprairie.us\/blog\/index.php\/wpjson\/wp\/v2\/comments?post=1171"}],"version-history":[{"count":1,"href":"https:\/\/www.wiredprairie.us\/blog\/index.php\/wpjson\/wp\/v2\/posts\/1171\/revisions"}],"predecessor-version":[{"id":1176,"href":"https:\/\/www.wiredprairie.us\/blog\/index.php\/wpjson\/wp\/v2\/posts\/1171\/revisions\/1176"}],"wp:attachment":[{"href":"https:\/\/www.wiredprairie.us\/blog\/index.php\/wpjson\/wp\/v2\/media?parent=1171"}],"wp:term":[{"taxonomy":"category","embeddable":true,"href":"https:\/\/www.wiredprairie.us\/blog\/index.php\/wpjson\/wp\/v2\/categories?post=1171"},{"taxonomy":"post_tag","embeddable":true,"href":"https:\/\/www.wiredprairie.us\/blog\/index.php\/wpjson\/wp\/v2\/tags?post=1171"}],"curies":[{"name":"wp","href":"https:\/\/api.w.org\/{rel}","templated":true}]}}